<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#6366f1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>ShopSmart - ×¨×©×™××ª ×§× ×™×•×ª ×—×›××”</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>tailwind.config = { darkMode: 'class' }</script>
    <style>
        * { font-family: 'Heebo', sans-serif; }
        .glass { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.2); }
        .dark .glass { background: rgba(30, 41, 59, 0.9); border: 1px solid rgba(255, 255, 255, 0.1); }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%); }
        .dark .gradient-bg { background: linear-gradient(135deg, #1e1b4b 0%, #312e81 50%, #4c1d95 100%); }
        .btn-gradient { background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); }
        .btn-gradient:hover { background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%); transform: translateY(-2px); box-shadow: 0 10px 40px rgba(99, 102, 241, 0.4); }
        .card-hover { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .card-hover:hover { transform: translateY(-4px) scale(1.02); }
        @keyframes float { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-10px); } }
        .float { animation: float 3s ease-in-out infinite; }
        @keyframes shimmer { 0% { background-position: -200% 0; } 100% { background-position: 200% 0; } }
        .shimmer { background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent); background-size: 200% 100%; animation: shimmer 2s infinite; }
        .progress-animate { background: linear-gradient(90deg, #6366f1, #8b5cf6, #a855f7, #8b5cf6, #6366f1); background-size: 200% 100%; animation: shimmer 2s linear infinite; }
        .text-gradient { background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        input:focus { outline: none; box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.3); }
        .scrollbar-thin::-webkit-scrollbar { width: 6px; }
        .scrollbar-thin::-webkit-scrollbar-track { background: transparent; }
        .scrollbar-thin::-webkit-scrollbar-thumb { background: rgba(99, 102, 241, 0.3); border-radius: 3px; }
        .scrollbar-thin::-webkit-scrollbar-thumb:hover { background: rgba(99, 102, 241, 0.5); }
    </style>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, addDoc, updateDoc, deleteDoc, doc, onSnapshot, query, orderBy, getDocs, where, serverTimestamp, arrayUnion, arrayRemove, getDoc, setDoc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        import {
            getAuth,
            createUserWithEmailAndPassword,
            signInWithEmailAndPassword,
            signOut,
            onAuthStateChanged,
            updateProfile,
            sendPasswordResetEmail
        } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';

        const firebaseConfig = {
            apiKey: "AIzaSyD3pwFMmo4mMjxgzUz5oPynt0D68Yy3Iz0",
            authDomain: "shooping-list-d846b.firebaseapp.com",
            projectId: "shooping-list-d846b",
            storageBucket: "shooping-list-d846b.firebasestorage.app",
            messagingSenderId: "1099114666122",
            appId: "1:1099114666122:web:5c704bf2da52aa3ca63573"
        };

        const app = initializeApp(firebaseConfig);
        window.db = getFirestore(app);
        window.auth = getAuth(app);
        window.firestore = { collection, addDoc, updateDoc, deleteDoc, doc, onSnapshot, query, orderBy, getDocs, where, serverTimestamp, arrayUnion, arrayRemove, getDoc, setDoc };
        window.firebaseAuth = {
            createUserWithEmailAndPassword,
            signInWithEmailAndPassword,
            signOut,
            onAuthStateChanged,
            updateProfile,
            sendPasswordResetEmail
        };
    </script>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect, createContext, useContext } = React;

        // Auth Context
        const AuthContext = createContext(null);

        function AuthProvider({ children }) {
            const [user, setUser] = useState(null);
            const [loading, setLoading] = useState(true);

            useEffect(() => {
                const unsubscribe = window.firebaseAuth.onAuthStateChanged(window.auth, (user) => {
                    setUser(user);
                    setLoading(false);
                });
                return () => unsubscribe();
            }, []);

            const value = { user, loading };
            return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;
        }

        function useAuth() {
            return useContext(AuthContext);
        }

        // Family Context
        const FamilyContext = createContext(null);

        function FamilyProvider({ children }) {
            const { user } = useAuth();
            const [family, setFamily] = useState(null);
            const [lists, setLists] = useState([]);
            const [currentList, setCurrentList] = useState(null);
            const [loading, setLoading] = useState(true);
            const [activities, setActivities] = useState([]);

            // Generate random 6-character code
            const generateCode = () => {
                const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
                let code = '';
                for (let i = 0; i < 6; i++) {
                    code += chars.charAt(Math.floor(Math.random() * chars.length));
                }
                return code;
            };

            // Find user's family
            useEffect(() => {
                if (!user) {
                    setFamily(null);
                    setLists([]);
                    setCurrentList(null);
                    setLoading(false);
                    return;
                }

                setLoading(true);

                // Query families where user is a member
                const q = window.firestore.query(
                    window.firestore.collection(window.db, 'families')
                );

                const unsubscribe = window.firestore.onSnapshot(q, async (snapshot) => {
                    let userFamily = null;
                    snapshot.forEach((doc) => {
                        const data = doc.data();
                        const isMember = data.members?.some(m => m.userId === user.uid);
                        if (isMember) {
                            userFamily = { id: doc.id, ...data };
                        }
                    });

                    setFamily(userFamily);
                    setLoading(false);
                });

                return () => unsubscribe();
            }, [user]);

            // Load lists when family changes
            useEffect(() => {
                if (!family) {
                    setLists([]);
                    setCurrentList(null);
                    return;
                }

                const q = window.firestore.query(
                    window.firestore.collection(window.db, 'lists'),
                    window.firestore.where('familyId', '==', family.id)
                );

                const unsubscribe = window.firestore.onSnapshot(q, (snapshot) => {
                    const listsData = [];
                    snapshot.forEach((doc) => {
                        listsData.push({ id: doc.id, ...doc.data() });
                    });
                    listsData.sort((a, b) => (b.isDefault ? 1 : 0) - (a.isDefault ? 1 : 0));
                    setLists(listsData);

                    // Set current list to default or first
                    if (!currentList || !listsData.find(l => l.id === currentList.id)) {
                        const defaultList = listsData.find(l => l.isDefault) || listsData[0];
                        setCurrentList(defaultList);
                    }
                });

                return () => unsubscribe();
            }, [family]);

            // Load activities
            useEffect(() => {
                if (!family) {
                    setActivities([]);
                    return;
                }

                const q = window.firestore.query(
                    window.firestore.collection(window.db, 'activity'),
                    window.firestore.where('familyId', '==', family.id)
                );

                const unsubscribe = window.firestore.onSnapshot(q, (snapshot) => {
                    const activitiesData = [];
                    snapshot.forEach((doc) => {
                        activitiesData.push({ id: doc.id, ...doc.data() });
                    });
                    activitiesData.sort((a, b) => {
                        const dateA = a.timestamp?.toDate?.() || new Date(0);
                        const dateB = b.timestamp?.toDate?.() || new Date(0);
                        return dateB - dateA;
                    });
                    setActivities(activitiesData.slice(0, 50));
                });

                return () => unsubscribe();
            }, [family]);

            // Create a new family
            const createFamily = async (familyName) => {
                if (!user) return null;

                const code = generateCode();
                const newFamily = {
                    name: familyName,
                    code: code,
                    adminId: user.uid,
                    members: [{
                        userId: user.uid,
                        email: user.email,
                        displayName: user.displayName || user.email,
                        joinedAt: new Date(),
                        role: 'admin'
                    }],
                    createdAt: new Date()
                };

                const familyRef = await window.firestore.addDoc(
                    window.firestore.collection(window.db, 'families'),
                    newFamily
                );

                // Create default list
                await window.firestore.addDoc(
                    window.firestore.collection(window.db, 'lists'),
                    {
                        familyId: familyRef.id,
                        name: '×¨×©×™××ª ×§× ×™×•×ª',
                        icon: 'ğŸ›’',
                        createdBy: user.uid,
                        createdAt: new Date(),
                        isDefault: true
                    }
                );

                // Log activity
                await logActivity('member_joined', { memberName: user.displayName || user.email }, familyRef.id);

                return { id: familyRef.id, ...newFamily };
            };

            // Join existing family
            const joinFamily = async (code) => {
                if (!user) return { success: false, error: '×œ× ××—×•×‘×¨' };

                const q = window.firestore.query(
                    window.firestore.collection(window.db, 'families'),
                    window.firestore.where('code', '==', code.toUpperCase())
                );

                const snapshot = await window.firestore.getDocs(q);

                if (snapshot.empty) {
                    return { success: false, error: '×§×•×“ ×œ× × ××¦×' };
                }

                const familyDoc = snapshot.docs[0];
                const familyData = familyDoc.data();

                // Check if already a member
                if (familyData.members?.some(m => m.userId === user.uid)) {
                    return { success: false, error: '×›×‘×¨ ×—×‘×¨ ×‘××©×¤×—×” ×–×•' };
                }

                // Add user to family
                const newMember = {
                    userId: user.uid,
                    email: user.email,
                    displayName: user.displayName || user.email,
                    joinedAt: new Date(),
                    role: 'member'
                };

                await window.firestore.updateDoc(
                    window.firestore.doc(window.db, 'families', familyDoc.id),
                    { members: window.firestore.arrayUnion(newMember) }
                );

                // Log activity
                await logActivity('member_joined', { memberName: user.displayName || user.email }, familyDoc.id);

                return { success: true };
            };

            // Leave family
            const leaveFamily = async () => {
                if (!family || !user) return;

                const memberToRemove = family.members.find(m => m.userId === user.uid);
                if (!memberToRemove) return;

                // If admin and only member, delete family
                if (family.adminId === user.uid && family.members.length === 1) {
                    // Delete all lists
                    const listsSnapshot = await window.firestore.getDocs(
                        window.firestore.query(
                            window.firestore.collection(window.db, 'lists'),
                            window.firestore.where('familyId', '==', family.id)
                        )
                    );
                    for (const doc of listsSnapshot.docs) {
                        await window.firestore.deleteDoc(doc.ref);
                    }
                    // Delete family
                    await window.firestore.deleteDoc(
                        window.firestore.doc(window.db, 'families', family.id)
                    );
                } else {
                    // Remove member
                    await window.firestore.updateDoc(
                        window.firestore.doc(window.db, 'families', family.id),
                        { members: window.firestore.arrayRemove(memberToRemove) }
                    );
                }
            };

            // Remove member (admin only)
            const removeMember = async (memberUserId) => {
                if (!family || family.adminId !== user.uid) return;
                if (memberUserId === user.uid) return; // Can't remove self

                const memberToRemove = family.members.find(m => m.userId === memberUserId);
                if (!memberToRemove) return;

                await window.firestore.updateDoc(
                    window.firestore.doc(window.db, 'families', family.id),
                    { members: window.firestore.arrayRemove(memberToRemove) }
                );
            };

            // Create new list
            const createList = async (name, icon = 'ğŸ“') => {
                if (!family) return;

                await window.firestore.addDoc(
                    window.firestore.collection(window.db, 'lists'),
                    {
                        familyId: family.id,
                        name: name,
                        icon: icon,
                        createdBy: user.uid,
                        createdAt: new Date(),
                        isDefault: false
                    }
                );

                await logActivity('list_created', { listName: name });
            };

            // Delete list
            const deleteList = async (listId) => {
                if (!family) return;
                const list = lists.find(l => l.id === listId);
                if (!list || list.isDefault) return; // Can't delete default list

                await window.firestore.deleteDoc(
                    window.firestore.doc(window.db, 'lists', listId)
                );
            };

            // Log activity
            const logActivity = async (type, details = {}, overrideFamilyId = null) => {
                if (!user) return;
                const fid = overrideFamilyId || family?.id;
                if (!fid) return;

                await window.firestore.addDoc(
                    window.firestore.collection(window.db, 'activity'),
                    {
                        familyId: fid,
                        listId: currentList?.id || null,
                        type: type,
                        userId: user.uid,
                        userName: user.displayName || user.email,
                        timestamp: new Date(),
                        ...details
                    }
                );
            };

            const value = {
                family,
                lists,
                currentList,
                setCurrentList,
                activities,
                loading,
                createFamily,
                joinFamily,
                leaveFamily,
                removeMember,
                createList,
                deleteList,
                logActivity,
                isAdmin: family?.adminId === user?.uid
            };

            return <FamilyContext.Provider value={value}>{children}</FamilyContext.Provider>;
        }

        function useFamily() {
            return useContext(FamilyContext);
        }

        // No Family Screen
        function NoFamilyScreen() {
            const [mode, setMode] = useState('choose'); // choose, create, join
            const [familyName, setFamilyName] = useState('');
            const [joinCode, setJoinCode] = useState('');
            const [error, setError] = useState('');
            const [loading, setLoading] = useState(false);
            const [createdCode, setCreatedCode] = useState('');
            const { createFamily, joinFamily } = useFamily();
            const { user } = useAuth();
            const [darkMode, setDarkMode] = useState(false);

            useEffect(() => {
                const savedDark = localStorage.getItem('darkMode') === 'true';
                if (savedDark) {
                    setDarkMode(true);
                    document.documentElement.classList.add('dark');
                }
            }, []);

            const handleCreate = async (e) => {
                e.preventDefault();
                if (!familyName.trim()) {
                    setError('× × ×œ×”×–×™×Ÿ ×©× ×œ××©×¤×—×”');
                    return;
                }
                setLoading(true);
                setError('');
                try {
                    const newFamily = await createFamily(familyName.trim());
                    setCreatedCode(newFamily.code);
                    setMode('created');
                } catch (err) {
                    setError('×©×’×™××” ×‘×™×¦×™×¨×ª ××©×¤×—×”');
                } finally {
                    setLoading(false);
                }
            };

            const handleJoin = async (e) => {
                e.preventDefault();
                if (!joinCode.trim() || joinCode.trim().length !== 6) {
                    setError('× × ×œ×”×–×™×Ÿ ×§×•×“ ×‘×Ÿ 6 ×ª×•×•×™×');
                    return;
                }
                setLoading(true);
                setError('');
                try {
                    const result = await joinFamily(joinCode.trim());
                    if (!result.success) {
                        setError(result.error);
                    }
                } catch (err) {
                    setError('×©×’×™××” ×‘×”×¦×˜×¨×¤×•×ª');
                } finally {
                    setLoading(false);
                }
            };

            const handleLogout = async () => {
                await window.firebaseAuth.signOut(window.auth);
            };

            const toggleDarkMode = () => {
                const newMode = !darkMode;
                setDarkMode(newMode);
                localStorage.setItem('darkMode', String(newMode));
                document.documentElement.classList.toggle('dark');
            };

            return (
                <div className="min-h-screen gradient-bg flex items-center justify-center p-4">
                    <div className="glass rounded-3xl shadow-2xl p-8 max-w-md w-full relative overflow-hidden">
                        <div className="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500"></div>

                        <button onClick={toggleDarkMode} className="absolute top-6 left-6 p-2.5 rounded-xl bg-white/50 dark:bg-gray-700/50 text-2xl hover:scale-110 transition-all">
                            {darkMode ? 'â˜€ï¸' : 'ğŸŒ™'}
                        </button>

                        <button onClick={handleLogout} className="absolute top-6 right-6 p-2.5 rounded-xl bg-red-100 dark:bg-red-900/50 text-sm text-red-600 dark:text-red-400 hover:scale-105 transition-all">
                            ×”×ª× ×ª×§
                        </button>

                        <div className="text-center mb-8 pt-8">
                            <div className="text-7xl mb-4 float">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦</div>
                            <h1 className="text-2xl font-bold text-gradient mb-2">×‘×¨×•×š ×”×‘×, {user?.displayName || '××©×ª××©'}!</h1>
                            <p className="text-gray-500 dark:text-gray-400 text-sm">×¦×•×¨ ××©×¤×—×” ×—×“×©×” ××• ×”×¦×˜×¨×£ ×œ××©×¤×—×” ×§×™×™××ª</p>
                        </div>

                        {mode === 'choose' && (
                            <div className="space-y-4">
                                <button onClick={() => setMode('create')} className="w-full btn-gradient text-white py-4 rounded-xl font-semibold hover:shadow-lg transition-all flex items-center justify-center gap-3">
                                    <span className="text-2xl">ğŸ </span>
                                    ×¦×•×¨ ××©×¤×—×” ×—×“×©×”
                                </button>
                                <button onClick={() => setMode('join')} className="w-full glass border-2 border-indigo-300 dark:border-indigo-600 py-4 rounded-xl font-semibold hover:bg-indigo-50 dark:hover:bg-indigo-900/30 transition-all flex items-center justify-center gap-3 text-gray-700 dark:text-gray-200">
                                    <span className="text-2xl">ğŸ”—</span>
                                    ×”×¦×˜×¨×£ ×œ××©×¤×—×” ×§×™×™××ª
                                </button>
                            </div>
                        )}

                        {mode === 'create' && (
                            <form onSubmit={handleCreate} className="space-y-4">
                                <h2 className="text-xl font-bold text-center text-gray-800 dark:text-white mb-4">×™×¦×™×¨×ª ××©×¤×—×”</h2>

                                {error && (
                                    <div className="bg-red-100 dark:bg-red-900/30 border-2 border-red-300 dark:border-red-700 text-red-700 dark:text-red-300 px-4 py-3 rounded-lg text-sm">
                                        {error}
                                    </div>
                                )}

                                <div>
                                    <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">×©× ×”××©×¤×—×”</label>
                                    <input
                                        type="text"
                                        value={familyName}
                                        onChange={e => setFamilyName(e.target.value)}
                                        placeholder="×œ×“×•×’××”: ××©×¤×—×ª ×›×”×Ÿ"
                                        className="w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-xl dark:bg-gray-700 dark:text-white focus:border-indigo-500"
                                        required
                                    />
                                </div>

                                <button type="submit" disabled={loading} className="w-full btn-gradient text-white py-3 rounded-xl font-semibold disabled:opacity-50">
                                    {loading ? '×™×•×¦×¨...' : '×¦×•×¨ ××©×¤×—×”'}
                                </button>

                                <button type="button" onClick={() => { setMode('choose'); setError(''); }} className="w-full text-indigo-600 dark:text-indigo-400 text-sm hover:underline">
                                    ×—×–×•×¨
                                </button>
                            </form>
                        )}

                        {mode === 'join' && (
                            <form onSubmit={handleJoin} className="space-y-4">
                                <h2 className="text-xl font-bold text-center text-gray-800 dark:text-white mb-4">×”×¦×˜×¨×¤×•×ª ×œ××©×¤×—×”</h2>

                                {error && (
                                    <div className="bg-red-100 dark:bg-red-900/30 border-2 border-red-300 dark:border-red-700 text-red-700 dark:text-red-300 px-4 py-3 rounded-lg text-sm">
                                        {error}
                                    </div>
                                )}

                                <div>
                                    <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">×§×•×“ ××©×¤×—×”</label>
                                    <input
                                        type="text"
                                        value={joinCode}
                                        onChange={e => setJoinCode(e.target.value.toUpperCase())}
                                        placeholder="ABC123"
                                        maxLength={6}
                                        className="w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-xl dark:bg-gray-700 dark:text-white focus:border-indigo-500 text-center text-2xl tracking-widest font-mono"
                                        dir="ltr"
                                        required
                                    />
                                    <p className="text-xs text-gray-500 dark:text-gray-400 mt-1 text-center">×§×‘×œ ××ª ×”×§×•×“ ××× ×”×œ ×”××©×¤×—×”</p>
                                </div>

                                <button type="submit" disabled={loading} className="w-full btn-gradient text-white py-3 rounded-xl font-semibold disabled:opacity-50">
                                    {loading ? '××¦×˜×¨×£...' : '×”×¦×˜×¨×£'}
                                </button>

                                <button type="button" onClick={() => { setMode('choose'); setError(''); }} className="w-full text-indigo-600 dark:text-indigo-400 text-sm hover:underline">
                                    ×—×–×•×¨
                                </button>
                            </form>
                        )}

                        {mode === 'created' && (
                            <div className="text-center space-y-4">
                                <div className="text-6xl mb-4">ğŸ‰</div>
                                <h2 className="text-xl font-bold text-gradient">×”××©×¤×—×” × ×•×¦×¨×”!</h2>
                                <p className="text-gray-600 dark:text-gray-400">×©×ª×£ ××ª ×”×§×•×“ ×”×–×” ×¢× ×‘× ×™ ×”××©×¤×—×”:</p>
                                <div className="bg-indigo-100 dark:bg-indigo-900/50 px-6 py-4 rounded-xl">
                                    <div className="text-3xl font-mono font-bold text-indigo-600 dark:text-indigo-400 tracking-widest">{createdCode}</div>
                                </div>
                                <button
                                    onClick={() => navigator.clipboard.writeText(createdCode)}
                                    className="text-indigo-600 dark:text-indigo-400 text-sm hover:underline flex items-center justify-center gap-2 mx-auto"
                                >
                                    ğŸ“‹ ×”×¢×ª×§ ×§×•×“
                                </button>
                                <p className="text-xs text-gray-500 dark:text-gray-400">×”×“×£ ×™×ª×¨×¢× ×Ÿ ××•×˜×•××˜×™×ª...</p>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        // Family Settings Modal
        function FamilySettingsModal({ onClose }) {
            const { family, leaveFamily, removeMember, isAdmin } = useFamily();
            const { user } = useAuth();
            const [showLeaveConfirm, setShowLeaveConfirm] = useState(false);
            const [copied, setCopied] = useState(false);

            const copyCode = () => {
                navigator.clipboard.writeText(family.code);
                setCopied(true);
                setTimeout(() => setCopied(false), 2000);
            };

            const handleLeave = async () => {
                await leaveFamily();
                onClose();
            };

            return (
                <div className="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4">
                    <div className="glass rounded-3xl p-8 max-w-md w-full shadow-2xl max-h-[90vh] overflow-y-auto">
                        <div className="flex justify-between items-center mb-6">
                            <h2 className="text-2xl font-bold flex items-center gap-3">
                                <span className="text-3xl">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦</span>
                                <span className="text-gradient">{family.name}</span>
                            </h2>
                            <button onClick={onClose} className="w-10 h-10 flex items-center justify-center glass rounded-full text-gray-500 hover:text-red-500 text-2xl hover:scale-110 hover:rotate-90 transition-all">Ã—</button>
                        </div>

                        {/* Share Code */}
                        <div className="glass rounded-xl p-4 mb-6">
                            <h3 className="font-bold text-gray-700 dark:text-gray-300 mb-2">×§×•×“ ×”×–×× ×”</h3>
                            <div className="flex items-center gap-3">
                                <div className="flex-1 bg-indigo-100 dark:bg-indigo-900/50 px-4 py-3 rounded-lg text-center">
                                    <span className="text-2xl font-mono font-bold text-indigo-600 dark:text-indigo-400 tracking-widest">{family.code}</span>
                                </div>
                                <button onClick={copyCode} className="btn-gradient text-white px-4 py-3 rounded-lg hover:scale-105 transition-all">
                                    {copied ? 'âœ“' : 'ğŸ“‹'}
                                </button>
                            </div>
                            <p className="text-xs text-gray-500 dark:text-gray-400 mt-2 text-center">×©×ª×£ ××ª ×”×§×•×“ ×¢× ×‘× ×™ ××©×¤×—×” ×œ×”×¦×˜×¨×¤×•×ª</p>
                        </div>

                        {/* Members List */}
                        <div className="mb-6">
                            <h3 className="font-bold text-gray-700 dark:text-gray-300 mb-3">×—×‘×¨×™ ×”××©×¤×—×” ({family.members?.length})</h3>
                            <div className="space-y-2">
                                {family.members?.map((member, idx) => (
                                    <div key={idx} className="glass rounded-lg p-3 flex items-center justify-between">
                                        <div className="flex items-center gap-3">
                                            <div className="w-10 h-10 rounded-full bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center text-white font-bold">
                                                {member.displayName?.charAt(0)?.toUpperCase() || '?'}
                                            </div>
                                            <div>
                                                <div className="font-medium dark:text-white">{member.displayName}</div>
                                                <div className="text-xs text-gray-500 dark:text-gray-400">{member.role === 'admin' ? 'ğŸ‘‘ ×× ×”×œ' : '×—×‘×¨'}</div>
                                            </div>
                                        </div>
                                        {isAdmin && member.userId !== user.uid && (
                                            <button
                                                onClick={() => removeMember(member.userId)}
                                                className="text-red-500 hover:bg-red-100 dark:hover:bg-red-900/30 p-2 rounded-lg transition-colors"
                                                title="×”×¡×¨ ×—×‘×¨"
                                            >
                                                ğŸ—‘
                                            </button>
                                        )}
                                    </div>
                                ))}
                            </div>
                        </div>

                        {/* Leave Family */}
                        {!showLeaveConfirm ? (
                            <button
                                onClick={() => setShowLeaveConfirm(true)}
                                className="w-full bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 py-3 rounded-xl font-semibold hover:bg-red-200 dark:hover:bg-red-900/50 transition-colors"
                            >
                                {isAdmin && family.members?.length === 1 ? 'ğŸ—‘ ××—×§ ××©×¤×—×”' : 'ğŸšª ×¢×–×•×‘ ××©×¤×—×”'}
                            </button>
                        ) : (
                            <div className="glass rounded-xl p-4 border-2 border-red-300 dark:border-red-700">
                                <p className="text-center text-red-600 dark:text-red-400 mb-4 font-medium">
                                    {isAdmin && family.members?.length === 1
                                        ? '×”××©×¤×—×” ×ª×™××—×§ ×œ×¦××™×ª×•×ª. ×œ×”××©×™×š?'
                                        : '×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ×¢×–×•×‘?'}
                                </p>
                                <div className="flex gap-2">
                                    <button onClick={handleLeave} className="flex-1 bg-red-500 text-white py-2 rounded-lg font-semibold hover:bg-red-600">
                                        ×›×Ÿ, {isAdmin && family.members?.length === 1 ? '××—×§' : '×¢×–×•×‘'}
                                    </button>
                                    <button onClick={() => setShowLeaveConfirm(false)} className="flex-1 glass py-2 rounded-lg font-semibold">
                                        ×‘×™×˜×•×œ
                                    </button>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        // Create List Modal
        function CreateListModal({ onClose }) {
            const { createList } = useFamily();
            const [name, setName] = useState('');
            const [icon, setIcon] = useState('ğŸ“');
            const [loading, setLoading] = useState(false);

            const icons = ['ğŸ“', 'ğŸ›’', 'ğŸ‰', 'ğŸ ', 'ğŸ’Š', 'ğŸ¾', 'ğŸ‘¶', 'ğŸ½ï¸', 'ğŸ§¹', 'âœˆï¸'];

            const handleSubmit = async (e) => {
                e.preventDefault();
                if (!name.trim()) return;
                setLoading(true);
                await createList(name.trim(), icon);
                onClose();
            };

            return (
                <div className="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4">
                    <div className="glass rounded-3xl p-8 max-w-sm w-full shadow-2xl">
                        <div className="text-5xl text-center mb-4">ğŸ“‹</div>
                        <h2 className="text-xl font-bold text-center text-gradient mb-6">×¨×©×™××” ×—×“×©×”</h2>

                        <form onSubmit={handleSubmit} className="space-y-4">
                            <div>
                                <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">×©× ×”×¨×©×™××”</label>
                                <input
                                    type="text"
                                    value={name}
                                    onChange={e => setName(e.target.value)}
                                    placeholder="×œ×“×•×’××”: ×§× ×™×•×ª ×œ×©×‘×ª"
                                    className="w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-xl dark:bg-gray-700 dark:text-white focus:border-indigo-500"
                                    autoFocus
                                    required
                                />
                            </div>

                            <div>
                                <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">××™×™×§×•×Ÿ</label>
                                <div className="flex flex-wrap gap-2">
                                    {icons.map(i => (
                                        <button
                                            key={i}
                                            type="button"
                                            onClick={() => setIcon(i)}
                                            className={`text-2xl p-2 rounded-lg transition-all ${icon === i ? 'bg-indigo-100 dark:bg-indigo-900/50 scale-110' : 'hover:bg-gray-100 dark:hover:bg-gray-700'}`}
                                        >
                                            {i}
                                        </button>
                                    ))}
                                </div>
                            </div>

                            <div className="flex gap-3 pt-2">
                                <button type="submit" disabled={loading} className="flex-1 btn-gradient text-white py-3 rounded-xl font-semibold disabled:opacity-50">
                                    {loading ? '×™×•×¦×¨...' : '×¦×•×¨ ×¨×©×™××”'}
                                </button>
                                <button type="button" onClick={onClose} className="px-6 py-3 glass border-2 border-gray-300 dark:border-gray-600 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700">
                                    ×‘×™×˜×•×œ
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            );
        }

        // Activity Feed Modal
        function ActivityFeedModal({ onClose }) {
            const { activities, currentList, lists } = useFamily();
            const [filterList, setFilterList] = useState('all');

            const getActivityText = (activity) => {
                switch (activity.type) {
                    case 'item_added':
                        return `×”×•×¡×™×£ "${activity.itemName}"`;
                    case 'item_purchased':
                        return `×¡×™××Ÿ ×›× ×§× ×” "${activity.itemName}"`;
                    case 'item_deleted':
                        return `××—×§ "${activity.itemName}"`;
                    case 'quantity_changed':
                        return `×©×™× ×” ×›××•×ª ×©×œ "${activity.itemName}"`;
                    case 'member_joined':
                        return `${activity.memberName || activity.userName} ×”×¦×˜×¨×£ ×œ××©×¤×—×”`;
                    case 'list_created':
                        return `×™×¦×¨ ×¨×©×™××” "${activity.listName}"`;
                    case 'note_added':
                        return `×”×•×¡×™×£ ×”×¢×¨×” ×œ"${activity.itemName}"`;
                    default:
                        return activity.type;
                }
            };

            const getActivityIcon = (type) => {
                switch (type) {
                    case 'item_added': return 'â•';
                    case 'item_purchased': return 'âœ…';
                    case 'item_deleted': return 'ğŸ—‘ï¸';
                    case 'quantity_changed': return 'ğŸ”¢';
                    case 'member_joined': return 'ğŸ‘‹';
                    case 'list_created': return 'ğŸ“‹';
                    case 'note_added': return 'ğŸ“';
                    default: return 'ğŸ“Œ';
                }
            };

            const getRelativeTime = (date) => {
                if (!date) return '';
                const now = new Date();
                const d = date.toDate ? date.toDate() : date;
                const diff = Math.floor((now - d) / 1000);

                if (diff < 60) return '×¢×›×©×™×•';
                if (diff < 3600) return `×œ×¤× ×™ ${Math.floor(diff / 60)} ×“×§×•×ª`;
                if (diff < 86400) return `×œ×¤× ×™ ${Math.floor(diff / 3600)} ×©×¢×•×ª`;
                if (diff < 604800) return `×œ×¤× ×™ ${Math.floor(diff / 86400)} ×™××™×`;
                return d.toLocaleDateString('he-IL');
            };

            const filteredActivities = filterList === 'all'
                ? activities
                : activities.filter(a => a.listId === filterList);

            return (
                <div className="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4">
                    <div className="glass rounded-3xl p-8 max-w-lg w-full shadow-2xl max-h-[90vh] overflow-hidden flex flex-col">
                        <div className="flex justify-between items-center mb-4">
                            <h2 className="text-2xl font-bold flex items-center gap-3">
                                <span className="text-3xl">ğŸ“Š</span>
                                <span className="text-gradient">×¤×¢×™×œ×•×ª ××—×¨×•× ×”</span>
                            </h2>
                            <button onClick={onClose} className="w-10 h-10 flex items-center justify-center glass rounded-full text-gray-500 hover:text-red-500 text-2xl hover:scale-110 hover:rotate-90 transition-all">Ã—</button>
                        </div>

                        {lists.length > 1 && (
                            <div className="mb-4">
                                <select
                                    value={filterList}
                                    onChange={e => setFilterList(e.target.value)}
                                    className="w-full px-4 py-2 glass rounded-xl border-2 border-gray-200 dark:border-gray-600 dark:text-white"
                                >
                                    <option value="all">×›×œ ×”×¨×©×™××•×ª</option>
                                    {lists.map(list => (
                                        <option key={list.id} value={list.id}>{list.icon} {list.name}</option>
                                    ))}
                                </select>
                            </div>
                        )}

                        <div className="flex-1 overflow-y-auto space-y-3 scrollbar-thin">
                            {filteredActivities.length === 0 ? (
                                <div className="text-center py-12">
                                    <div className="text-6xl mb-4 float">ğŸ“­</div>
                                    <p className="text-gray-500 dark:text-gray-400">××™×Ÿ ×¤×¢×™×œ×•×ª ×¢×“×™×™×Ÿ</p>
                                </div>
                            ) : (
                                filteredActivities.map(activity => (
                                    <div key={activity.id} className="glass rounded-xl p-4 flex items-start gap-3">
                                        <div className="text-2xl">{getActivityIcon(activity.type)}</div>
                                        <div className="flex-1">
                                            <div className="text-sm dark:text-white">
                                                <span className="font-bold text-indigo-600 dark:text-indigo-400">{activity.userName}</span>
                                                {' '}{getActivityText(activity)}
                                            </div>
                                            <div className="text-xs text-gray-500 dark:text-gray-400 mt-1">
                                                {getRelativeTime(activity.timestamp)}
                                            </div>
                                        </div>
                                    </div>
                                ))
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        // Item Note Modal
        function ItemNoteModal({ item, onClose, onSave }) {
            const [note, setNote] = useState(item.note || '');
            const [loading, setLoading] = useState(false);

            const handleSave = async () => {
                setLoading(true);
                await onSave(note);
                onClose();
            };

            return (
                <div className="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4">
                    <div className="glass rounded-3xl p-8 max-w-sm w-full shadow-2xl">
                        <div className="text-5xl text-center mb-4">ğŸ“</div>
                        <h2 className="text-xl font-bold text-center text-gradient mb-2">×”×¢×¨×” ×œ××•×¦×¨</h2>
                        <p className="text-center text-gray-500 dark:text-gray-400 mb-4">{item.name}</p>

                        <textarea
                            value={note}
                            onChange={e => setNote(e.target.value)}
                            placeholder="×œ×“×•×’××”: ××•×ª×’ ××¡×, ××”××“×£ ×”×¢×œ×™×•×Ÿ..."
                            className="w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-xl dark:bg-gray-700 dark:text-white focus:border-indigo-500 resize-none h-24 mb-4"
                            autoFocus
                        />

                        <div className="flex gap-3">
                            <button onClick={handleSave} disabled={loading} className="flex-1 btn-gradient text-white py-3 rounded-xl font-semibold disabled:opacity-50">
                                {loading ? '×©×•××¨...' : '×©××•×¨'}
                            </button>
                            <button onClick={onClose} className="px-6 py-3 glass border-2 border-gray-300 dark:border-gray-600 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700">
                                ×‘×™×˜×•×œ
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        // Error message helper
        function getErrorMessage(errorCode) {
            const messages = {
                'auth/email-already-in-use': '×›×ª×•×‘×ª ×”××™××™×™×œ ×›×‘×¨ ×‘×©×™××•×©',
                'auth/invalid-email': '×›×ª×•×‘×ª ××™××™×™×œ ×œ× ×ª×§×™× ×”',
                'auth/operation-not-allowed': '×¤×¢×•×œ×” ×œ× ××•×¨×©×™×ª',
                'auth/weak-password': '×”×¡×™×¡××” ×—×œ×©×” ××“×™ (×œ×¤×—×•×ª 6 ×ª×•×•×™×)',
                'auth/user-disabled': '×”××©×ª××© ×”×•×©×‘×ª',
                'auth/user-not-found': '××©×ª××© ×œ× × ××¦×',
                'auth/wrong-password': '×¡×™×¡××” ×©×’×•×™×”',
                'auth/too-many-requests': '×™×•×ª×¨ ××“×™ × ×™×¡×™×•× ×•×ª, × ×¡×” ×©×•×‘ ×××•×—×¨ ×™×•×ª×¨',
                'auth/invalid-credential': '×¤×¨×˜×™ ×”×ª×—×‘×¨×•×ª ×©×’×•×™×™×',
                'auth/missing-password': '× × ×œ×”×–×™×Ÿ ×¡×™×¡××”'
            };
            return messages[errorCode] || '××™×¨×¢×” ×©×’×™××”, × ×¡×” ×©×•×‘';
        }

        // Sign Up Form
        function SignUpForm({ onSwitchToLogin }) {
            const [email, setEmail] = useState('');
            const [password, setPassword] = useState('');
            const [confirmPassword, setConfirmPassword] = useState('');
            const [displayName, setDisplayName] = useState('');
            const [error, setError] = useState('');
            const [loading, setLoading] = useState(false);

            const handleSignUp = async (e) => {
                e.preventDefault();
                setError('');

                if (!displayName.trim()) {
                    return setError('× × ×œ×”×–×™×Ÿ ×©× ×ª×¦×•×’×”');
                }
                if (password !== confirmPassword) {
                    return setError('×”×¡×™×¡×××•×ª ××™× ×Ÿ ×ª×•×××•×ª');
                }
                if (password.length < 6) {
                    return setError('×”×¡×™×¡××” ×—×™×™×‘×ª ×œ×”×™×•×ª ×œ×¤×—×•×ª 6 ×ª×•×•×™×');
                }

                try {
                    setLoading(true);
                    const userCredential = await window.firebaseAuth.createUserWithEmailAndPassword(
                        window.auth, email, password
                    );
                    await window.firebaseAuth.updateProfile(userCredential.user, {
                        displayName: displayName.trim()
                    });
                } catch (err) {
                    setError(getErrorMessage(err.code));
                } finally {
                    setLoading(false);
                }
            };

            return (
                <form onSubmit={handleSignUp} className="space-y-4">
                    <h2 className="text-2xl font-bold text-gray-800 dark:text-white text-center mb-6">×”×¨×©××”</h2>

                    {error && (
                        <div className="bg-red-100 dark:bg-red-900/30 border-2 border-red-300 dark:border-red-700 text-red-700 dark:text-red-300 px-4 py-3 rounded-lg text-sm">
                            {error}
                        </div>
                    )}

                    <div>
                        <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">×©× ×ª×¦×•×’×”</label>
                        <input
                            type="text"
                            value={displayName}
                            onChange={e => setDisplayName(e.target.value)}
                            placeholder="×”×©× ×©×™×•×¦×’ ×‘××¤×œ×™×§×¦×™×”"
                            className="w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:border-indigo-500 dark:focus:border-indigo-400 transition-colors"
                            required
                        />
                    </div>

                    <div>
                        <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">××™××™×™×œ</label>
                        <input
                            type="email"
                            value={email}
                            onChange={e => setEmail(e.target.value)}
                            placeholder="example@email.com"
                            className="w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:border-indigo-500 dark:focus:border-indigo-400 transition-colors"
                            dir="ltr"
                            required
                        />
                    </div>

                    <div>
                        <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">×¡×™×¡××”</label>
                        <input
                            type="password"
                            value={password}
                            onChange={e => setPassword(e.target.value)}
                            placeholder="×œ×¤×—×•×ª 6 ×ª×•×•×™×"
                            className="w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:border-indigo-500 dark:focus:border-indigo-400 transition-colors"
                            dir="ltr"
                            required
                        />
                    </div>

                    <div>
                        <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">××™××•×ª ×¡×™×¡××”</label>
                        <input
                            type="password"
                            value={confirmPassword}
                            onChange={e => setConfirmPassword(e.target.value)}
                            placeholder="×”×–×Ÿ ×©×•×‘ ××ª ×”×¡×™×¡××”"
                            className="w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:border-indigo-500 dark:focus:border-indigo-400 transition-colors"
                            dir="ltr"
                            required
                        />
                    </div>

                    <button
                        type="submit"
                        disabled={loading}
                        className="w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-3 rounded-lg font-semibold hover:from-indigo-700 hover:to-purple-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed"
                    >
                        {loading ? '× ×¨×©×...' : '×”×¨×©××”'}
                    </button>

                    <p className="text-center text-gray-600 dark:text-gray-400 text-sm">
                        ×›×‘×¨ ×™×© ×œ×š ×—×©×‘×•×Ÿ?{' '}
                        <button type="button" onClick={onSwitchToLogin} className="text-indigo-600 dark:text-indigo-400 font-semibold hover:underline">
                            ×”×ª×—×‘×¨×•×ª
                        </button>
                    </p>
                </form>
            );
        }

        // Login Form
        function LoginForm({ onSwitchToSignUp, onSwitchToReset }) {
            const [email, setEmail] = useState('');
            const [password, setPassword] = useState('');
            const [error, setError] = useState('');
            const [loading, setLoading] = useState(false);

            const handleLogin = async (e) => {
                e.preventDefault();
                setError('');

                try {
                    setLoading(true);
                    await window.firebaseAuth.signInWithEmailAndPassword(window.auth, email, password);
                } catch (err) {
                    setError(getErrorMessage(err.code));
                } finally {
                    setLoading(false);
                }
            };

            return (
                <form onSubmit={handleLogin} className="space-y-4">
                    <h2 className="text-2xl font-bold text-gray-800 dark:text-white text-center mb-6">×”×ª×—×‘×¨×•×ª</h2>

                    {error && (
                        <div className="bg-red-100 dark:bg-red-900/30 border-2 border-red-300 dark:border-red-700 text-red-700 dark:text-red-300 px-4 py-3 rounded-lg text-sm">
                            {error}
                        </div>
                    )}

                    <div>
                        <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">××™××™×™×œ</label>
                        <input
                            type="email"
                            value={email}
                            onChange={e => setEmail(e.target.value)}
                            placeholder="example@email.com"
                            className="w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:border-indigo-500 dark:focus:border-indigo-400 transition-colors"
                            dir="ltr"
                            required
                        />
                    </div>

                    <div>
                        <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">×¡×™×¡××”</label>
                        <input
                            type="password"
                            value={password}
                            onChange={e => setPassword(e.target.value)}
                            placeholder="×”×¡×™×¡××” ×©×œ×š"
                            className="w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:border-indigo-500 dark:focus:border-indigo-400 transition-colors"
                            dir="ltr"
                            required
                        />
                    </div>

                    <button
                        type="submit"
                        disabled={loading}
                        className="w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-3 rounded-lg font-semibold hover:from-indigo-700 hover:to-purple-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed"
                    >
                        {loading ? '××ª×—×‘×¨...' : '×”×ª×—×‘×¨×•×ª'}
                    </button>

                    <button
                        type="button"
                        onClick={onSwitchToReset}
                        className="w-full text-indigo-600 dark:text-indigo-400 text-sm hover:underline"
                    >
                        ×©×›×—×ª×™ ×¡×™×¡××”
                    </button>

                    <p className="text-center text-gray-600 dark:text-gray-400 text-sm">
                        ××™×Ÿ ×œ×š ×—×©×‘×•×Ÿ?{' '}
                        <button type="button" onClick={onSwitchToSignUp} className="text-indigo-600 dark:text-indigo-400 font-semibold hover:underline">
                            ×”×¨×©××”
                        </button>
                    </p>
                </form>
            );
        }

        // Password Reset Form
        function PasswordResetForm({ onSwitchToLogin }) {
            const [email, setEmail] = useState('');
            const [error, setError] = useState('');
            const [success, setSuccess] = useState(false);
            const [loading, setLoading] = useState(false);

            const handleReset = async (e) => {
                e.preventDefault();
                setError('');

                try {
                    setLoading(true);
                    await window.firebaseAuth.sendPasswordResetEmail(window.auth, email);
                    setSuccess(true);
                } catch (err) {
                    setError(getErrorMessage(err.code));
                } finally {
                    setLoading(false);
                }
            };

            if (success) {
                return (
                    <div className="text-center space-y-4">
                        <div className="text-6xl">ğŸ“§</div>
                        <h2 className="text-2xl font-bold text-gray-800 dark:text-white">× ×©×œ×—!</h2>
                        <p className="text-gray-600 dark:text-gray-400">
                            ×§×™×©×•×¨ ×œ××™×¤×•×¡ ×¡×™×¡××” × ×©×œ×— ×œ-<br/>
                            <span className="font-semibold" dir="ltr">{email}</span>
                        </p>
                        <p className="text-sm text-gray-500 dark:text-gray-500">×‘×“×•×§ ×’× ×‘×ª×™×§×™×™×ª ×”×¡×¤××</p>
                        <button
                            onClick={onSwitchToLogin}
                            className="text-indigo-600 dark:text-indigo-400 font-semibold hover:underline"
                        >
                            ×—×–×•×¨ ×œ×”×ª×—×‘×¨×•×ª
                        </button>
                    </div>
                );
            }

            return (
                <form onSubmit={handleReset} className="space-y-4">
                    <h2 className="text-2xl font-bold text-gray-800 dark:text-white text-center mb-2">××™×¤×•×¡ ×¡×™×¡××”</h2>
                    <p className="text-center text-gray-600 dark:text-gray-400 text-sm mb-6">
                        ×”×–×Ÿ ××ª ×›×ª×•×‘×ª ×”××™××™×™×œ ×©×œ×š ×•× ×©×œ×— ×œ×š ×§×™×©×•×¨ ×œ××™×¤×•×¡
                    </p>

                    {error && (
                        <div className="bg-red-100 dark:bg-red-900/30 border-2 border-red-300 dark:border-red-700 text-red-700 dark:text-red-300 px-4 py-3 rounded-lg text-sm">
                            {error}
                        </div>
                    )}

                    <div>
                        <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">××™××™×™×œ</label>
                        <input
                            type="email"
                            value={email}
                            onChange={e => setEmail(e.target.value)}
                            placeholder="example@email.com"
                            className="w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:border-indigo-500 dark:focus:border-indigo-400 transition-colors"
                            dir="ltr"
                            required
                        />
                    </div>

                    <button
                        type="submit"
                        disabled={loading}
                        className="w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-3 rounded-lg font-semibold hover:from-indigo-700 hover:to-purple-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed"
                    >
                        {loading ? '×©×•×œ×—...' : '×©×œ×— ×§×™×©×•×¨ ××™×¤×•×¡'}
                    </button>

                    <button
                        type="button"
                        onClick={onSwitchToLogin}
                        className="w-full text-indigo-600 dark:text-indigo-400 text-sm hover:underline"
                    >
                        ×—×–×•×¨ ×œ×”×ª×—×‘×¨×•×ª
                    </button>
                </form>
            );
        }

        // Auth Screen Container
        function AuthScreen() {
            const [mode, setMode] = useState('login');
            const [darkMode, setDarkMode] = useState(false);

            useEffect(() => {
                const savedDark = localStorage.getItem('darkMode') === 'true';
                if (savedDark) {
                    setDarkMode(true);
                    document.documentElement.classList.add('dark');
                }
            }, []);

            const toggleDarkMode = () => {
                const newMode = !darkMode;
                setDarkMode(newMode);
                localStorage.setItem('darkMode', String(newMode));
                document.documentElement.classList.toggle('dark');
            };

            return (
                <div className="min-h-screen gradient-bg flex items-center justify-center p-4">
                    <div className="glass rounded-3xl shadow-2xl p-8 max-w-md w-full relative overflow-hidden">
                        <div className="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500"></div>
                        <button
                            onClick={toggleDarkMode}
                            className="absolute top-6 left-6 p-2.5 rounded-xl bg-white/50 dark:bg-gray-700/50 text-2xl hover:scale-110 transition-all duration-300 shadow-lg"
                        >
                            {darkMode ? 'â˜€ï¸' : 'ğŸŒ™'}
                        </button>

                        <div className="text-center mb-8 pt-4">
                            <div className="text-7xl mb-4 float">ğŸ›’</div>
                            <h1 className="text-3xl font-bold text-gradient mb-2">ShopSmart</h1>
                            <p className="text-gray-500 dark:text-gray-400 text-sm">×¨×©×™××ª ×”×§× ×™×•×ª ×”×—×›××” ×©×œ×š</p>
                        </div>

                        {mode === 'login' && (
                            <LoginForm
                                onSwitchToSignUp={() => setMode('signup')}
                                onSwitchToReset={() => setMode('reset')}
                            />
                        )}
                        {mode === 'signup' && (
                            <SignUpForm onSwitchToLogin={() => setMode('login')} />
                        )}
                        {mode === 'reset' && (
                            <PasswordResetForm onSwitchToLogin={() => setMode('login')} />
                        )}
                    </div>
                </div>
            );
        }

        const CATEGORIES = {
            fruits: { name: '×¤×™×¨×•×ª ×•×™×¨×§×•×ª', icon: 'ğŸ¥¬' },
            dairy: { name: '×—×œ×‘×™', icon: 'ğŸ¥›' },
            desserts: { name: '××¢×“× ×™ ×—×œ×‘', icon: 'ğŸ®' },
            meat: { name: '×‘×©×¨ ×•×“×’×™×', icon: 'ğŸ—' },
            deli: { name: '××¢×“× ×™×”', icon: 'ğŸ¥“' },
            bakery: { name: '×œ×—× ×•×××¤×™×', icon: 'ğŸ' },
            cereals: { name: '×“×’× ×™× ×•×§×•×¨× ×¤×œ×§×¡', icon: 'ğŸ¥£' },
            canned: { name: '×©×™××•×¨×™× ×•××–×•×Ÿ ×™×‘×©', icon: 'ğŸ¥«' },
            spices: { name: '×ª×‘×œ×™× ×™× ×•×‘×™×©×•×œ', icon: 'ğŸ§‚' },
            coffee: { name: '×§×¤×” ×•×ª×”', icon: 'â˜•' },
            drinks: { name: '××©×§××•×ª', icon: 'ğŸ¥¤' },
            snacks: { name: '×—×˜×™×¤×™× ×•×××ª×§×™×', icon: 'ğŸ¿' },
            frozen: { name: '×§×¤×•××™×', icon: 'ğŸ§Š' },
            health: { name: '×“×™××˜×” ×•×—×œ×‘×•×Ÿ', icon: 'ğŸ’ª' },
            hygiene: { name: '×”×™×’×™×™× ×” ×•×¨×—×¦×”', icon: 'ğŸ§´' },
            cleaning: { name: '× ×™×§×™×•×Ÿ', icon: 'ğŸ§¹' },
            candles: { name: '× ×¨×•×ª ×•×©××Ÿ', icon: 'ğŸ•¯ï¸' },
            baby: { name: '×ª×™× ×•×§×•×ª ×•×™×œ×“×™×', icon: 'ğŸ‘¶' },
            pets: { name: '×—×™×•×ª ××—××“', icon: 'ğŸ¾' },
            other: { name: '××—×¨', icon: 'ğŸ“¦' }
        };

        const PRODUCTS = {
            dairy: ['×—×œ×‘', '×—×œ×‘ 3%', '×—×œ×‘ 1%', '×—×œ×‘ ×“×œ ×©×•××Ÿ', '×—×œ×‘ ×¡×•×™×”', '×—×œ×‘ ×©×§×“×™×', '×—×œ×‘ ×§×•×§×•×¡', '×—×œ×‘ ×©×™×‘×•×œ×ª ×©×•×¢×œ', '×œ×‘×Ÿ', '×œ×‘×Ÿ ×¢×–', '×’×‘×™× ×” ×¦×”×•×‘×”', '×’×‘×™× ×” ×¦×”×•×‘×” ×¢××§', '×’×‘×™× ×” ×¦×”×•×‘×” ×’×œ×‘×•×¢', '×’×‘×™× ×” ×¦×”×•×‘×” 9%', '×’×‘×™× ×” ×¦×”×•×‘×” 22%', '×§×•×˜×’×³', '×§×•×˜×’×³ 5%', '×§×•×˜×’×³ 3%', '×§×•×˜×’×³ 0%', '×’×‘×™× ×” ×‘×•×œ×’×¨×™×ª', '×¦×¤×ª×™×ª', '×’×‘×™× ×ª ×©×× ×ª', '×¤×¨××–×Ÿ', '××•×¦×¨×œ×”', '××•×¦×¨×œ×” ×˜×¨×™×™×”', '×‘×™×¦×™×', '×‘×™×¦×™× L', '×‘×™×¦×™× XL', '×‘×™×¦×™× ××•×¨×’× ×™×•×ª', '×‘×™×¦×™× ×—×•×¤×©×™×•×ª', '×—×××”', '×—×××” ××œ×•×—×”', '×©×× ×ª ××ª×•×§×”', '×©×× ×ª ×—××•×¦×”', '×©×× ×ª ×œ×§×¦×¤×ª', '×™×•×’×•×¨×˜', '×™×•×’×•×¨×˜ ×™×•×•× ×™', '×™×•×’×•×¨×˜ ×™×•×•× ×™ 0%', '×™×•×’×•×¨×˜ ×ª× ×•×‘×”', '×™×•×’×•×¨×˜ ×©×˜×¨××•×¡', '×™×•×’×•×¨×˜ ××§×˜×™×‘×™×”', '×’×‘×™× ×” ×œ×‘× ×”', '×’×‘×™× ×” ×œ×‘× ×” 5%', '×’×‘×™× ×” ×œ×‘× ×” 9%', '×™×•×’×•×¨×˜ ××•×¨×’× ×™', '×™×•×’×•×¨×˜ ×œ×™×œ×“×™×', '×’×‘×™× ×ª ×¢×–×™×', '×’×‘×™× ×ª ×¨×•×§×¤×•×¨', '×§×©×§×‘×œ', '×’××•×“×”', '××× ×˜×œ', '×‘×¨×™', '×§×××‘×¨', '×—×œ×•××™', '×¤×™×œ×“×œ×¤×™×”', '×œ××‘× ×”', '×¨×™×§×•×˜×”', '××¡×§×¨×¤×•× ×”', '×’×‘×™× ×ª ×ª×¤×•×—', '×—×××” ×‘×¦×œ', '×—×××” ×©×•×', '××¨×’×¨×™× ×”', '×˜×•×¤×•', '×˜×•×¤×• ××•×§×©×”'],

            fruits: ['×¢×’×‘× ×™×•×ª', '×¢×’×‘× ×™×•×ª ×©×¨×™', '×¢×’×‘× ×™×•×ª ×¢× ×‘×™×', '×¢×’×‘× ×™×•×ª ××’×™', '××œ×¤×¤×•× ×™×', '××œ×¤×¤×•×Ÿ ×‘×™×™×‘×™', '××œ×¤×¤×•×Ÿ ×—××•×¥', '×‘×¦×œ', '×‘×¦×œ ×¡×’×•×œ', '×‘×¦×œ ×™×¨×•×§', '×©×•×', '×¨××© ×©×•×', '×©×•× ×§×œ×•×£', '×¤×œ×¤×œ ××“×•×', '×¤×œ×¤×œ ×™×¨×•×§', '×¤×œ×¤×œ ×¦×”×•×‘', '×¤×œ×¤×œ ×›×ª×•×', '×¤×œ×¤×œ ×—×¨×™×£', '×—×¡×”', '×—×¡×” ××™×™×¡×‘×¨×’', '×—×¡×” ×¨×•××™×ª', '×›×¨×•×‘', '×›×¨×•×‘ ×¡×’×•×œ', '×›×¨×•×‘ ×¡×™× ×™', '×’×–×¨', '×’×–×¨ ×‘×™×™×‘×™', '×¡×œ×§', '×¡×œ×§ ××‘×•×©×œ', '×ª×¤×•×—×™ ××“××”', '×ª×¤×•×´× ××“×•×', '×ª×¤×•×´× ×œ×‘×Ÿ', '×‘×˜×˜×”', '×‘×˜×˜×” ×›×ª×•××”', '×§×™×©×•×', '×§×™×©×•× ×™×¨×•×§', '×—×¦×™×œ', '×‘×¨×•×§×•×œ×™', '×›×¨×•×‘×™×ª', '×ª×¨×“', '×ª×¨×“ ×‘×™×™×‘×™', '×©××™×¨', '×˜×¨×’×•×Ÿ', '×¨××©××“', '×¨×™×—×Ÿ', '× ×¢× ×¢', '×¨×•×§×˜', '×¤×˜×¨×•×–×™×œ×™×”', '×›×•×¡×‘×¨×”', '×¡×œ×¨×™', '×©×•××¨', '×§×•×œ×•×¨×‘×™', '××¨×˜×™×©×•×§', '××¡×¤×¨×’×•×¡', '×¤×˜×¨×™×•×ª', '×¤×˜×¨×™×•×ª ×©××¤×™× ×™×•×Ÿ', '×¤×˜×¨×™×•×ª ×¤×•×¨×˜×•×‘×œ×•', '×œ×™××•×Ÿ', '×œ×™×™×', '×‘× × ×•×ª', '×ª×¤×•×—×™×', '×ª×¤×•×—×™× ×™×¨×•×§×™×', '×ª×¤×•×—×™× ××“×•××™×', '×ª×¤×•×–×™×', '××©×›×•×œ×™×ª', '××©×›×•×œ×™×ª ××“×•××”', '×¤×•××œ×”', '××‘×˜×™×—', '××œ×•×Ÿ', '××œ×•×Ÿ ×’×œ×™×”', '×¢× ×‘×™×', '×¢× ×‘×™× ×™×¨×•×§×™×', '×¢× ×‘×™× ×©×—×•×¨×™×', '××’×¡', '×©×–×™×¤×™×', '××¤×¨×¡×§×™×', '× ×§×˜×¨×™× ×•×ª', '×§×œ×× ×˜×™× ×•×ª', '×§×™×•×•×™', '×¨×™××•× ×™×', '×× ×’×•', '×× × ×¡', '××‘×•×§×“×•', '×ª×•×ª×™×', '×¤×˜×œ', '××•×›×× ×™×•×ª', '×“×•×‘×“×‘× ×™×', '××©××©', '×ª×× ×™×', '×¤×¡×™×¤×œ×•×¨×”', '×¤×¤××™×”', '×§×¨××‘×•×œ×”', '×œ×™×¦\'×™', '×“×¨×§×•×Ÿ ×¤×¨×™', '×§×•×§×•×¡'],

            bakery: ['×œ×—×', '×œ×—× ××œ×', '×œ×—× ×©×™×¤×•×Ÿ', '×œ×—× ×›×•×¡××™×Ÿ', '×œ×—× ×“×’× ×™×', '×œ×—× ×¤×¨×•×¡', '×œ×—× ××—×™×“', '×œ×—× ×œ×œ× ×’×œ×•×˜×Ÿ', '×—×œ×”', '×—×œ×” ××œ××”', '×—×œ×” ××ª×•×§×”', '×¢×•×’×™×•×ª', '×¢×•×’×™×•×ª ×©×•×§×•×œ×“ ×¦\'×™×¤×¡', '×¢×•×’×™×•×ª ×—×××”', '×¤×™×ª×•×ª', '×¤×™×ª×•×ª ××œ××•×ª', '×¤×™×ª×•×ª ××™× ×™', '×œ×—×× ×™×•×ª', '×œ×—×× ×™×•×ª ×”××‘×•×¨×’×¨', '×œ×—×× ×™×•×ª × ×§× ×™×§×™×”', '×‘×’×˜', '×¦\'×‘×˜×”', '×¤×•×§×¦\'×”', '×¨×•×œ×“×”', '×œ×—× ×©×•××©×•×', '×œ×—× ×¤×©×•×˜', '××¦×•×ª', '××¦×•×ª ××œ××•×ª', '×§×¨×§×¨×™×', '×œ×—× ×§×œ', '×˜×•×¨×˜×™×™×”', '×œ××¤×”', '× ××Ÿ', '×§×¨×•××¡×•×Ÿ', '×§×¨×•××¡×•×Ÿ ×©×•×§×•×œ×“', '×‘×¨×™×•×©', '×¡×•×¤×’× ×™×•×ª', '×“×•× ××˜×¡', '×××¤×™× ×¡', '×¢×•×’×ª ×©××¨×™×', '×©×˜×¨×•×“×œ', '×¨×•×’×œ×š', '×‘×•×¨×§×¡', '×‘×•×¨×§×¡ ×’×‘×™× ×”', '×‘×•×¨×§×¡ ×ª×¤×•×´×', '×‘×•×¨×§×¡ ×¤×˜×¨×™×•×ª'],

            meat: ['×¢×•×£ ×©×œ×', '×—×–×” ×¢×•×£', '×—×–×” ×¢×•×£ ×œ×œ× ×¢×•×¨', '×—×–×” ×¢×•×£ ×¤×¨×•×¡', '×›×¨×¢×™×™× ×¢×•×£', '×©×•×§×™×™× ×¢×•×£', '×›× ×¤×™×™× ×¢×•×£', '×¢×•×£ ×˜×—×•×Ÿ', '×›×‘×“ ×¢×•×£', '×œ×‘×‘×•×ª ×¢×•×£', '×¤×¨×’×™×ª', '×—×–×” ×”×•×“×•', '×”×•×“×• ×˜×—×•×Ÿ', '×‘×©×¨ ×˜×—×•×Ÿ', '×‘×©×¨ ×˜×—×•×Ÿ ×¨×–×”', '×× ×˜×¨×™×§×•×˜', '×¡×™× ×˜×”', '×¤×™×œ×” ×‘×§×¨', '×¦×œ×¢×•×ª ×‘×§×¨', '×©×¤×•× ×“×¨×”', '××¡××“×•', '×’×•×œ×©', '×‘×©×¨ ×œ×©×•×•××¨××”', '×˜×œ×”', '×›×‘×©', '×©× ×™×¦×œ ×¢×•×£', '×©× ×™×¦×œ ×”×•×“×•', '×§×‘×‘', '×”××‘×•×¨×’×¨', '×”××‘×•×¨×’×¨ ×‘×™×ª×™', '× ×§× ×™×§×™×•×ª ×¢×•×£', '× ×§× ×™×§×™×•×ª ×‘×§×¨', '×¡×œ××•×Ÿ', '×¡×œ××•×Ÿ ×˜×¨×™', '×¡×œ××•×Ÿ ××¢×•×©×Ÿ', '×¤×™×œ×” ×¡×œ××•×Ÿ', '×¤×™×œ×” ××× ×•×Ÿ', '×¤×™×œ×” ×‘×•×¨×™', '×¤×™×œ×” ×“× ×™×¡', '×˜×•× ×” ×˜×¨×™×™×”', '×“×’ ×©×œ×', '× ×¡×™×›×™ ×™×', '×©×¨×™××¤×¡', '×§×œ×××¨×™', '××•×œ×™×', '×¡×¨×“×™× ×™×', '×“×’ ××¢×•×©×Ÿ', '×‘×©×¨ ××¢×•×‘×“'],

            desserts: ['××™×œ×§×™', '××™×œ×§×™ ××§×•×¨×™', '××™×œ×§×™ ××•×¨××•', '×“× ×•× ×”', '×“× ×•× ×” ×©×•×§×•×œ×“', '×™×•×¤×œ×”', '×“× ×™××œ×”', '×“× ×™××œ×” ×§×¨××œ', '××¢×“×Ÿ ×•× ×™×œ', '××¢×“×Ÿ ×©×•×§×•×œ×“', '××¢×“×Ÿ ×§×¨××œ', '××¢×“×Ÿ ×‘×™×¡×§×•×•×™×˜×™×', '××¢×“×Ÿ ×œ×•×˜×•×¡', '×©×•×§×• ×™×˜×‘×ª×”', '×©×•×§×• ×ª× ×•×‘×”', '×¤×•×“×™× ×’', '×¤×•×“×™× ×’ ×©×•×§×•×œ×“', '×¤×•×“×™× ×’ ×•× ×™×œ', '××¢×“×Ÿ ×™×•×’×•×¨×˜', '××¢×“×Ÿ ×ª×•×ª', '××¢×“×Ÿ ×‘× × ×”', '××•×¡ ×©×•×§×•×œ×“', '××•×¡ ×•× ×™×œ', '×¤×¨×™ ×’×“', '×“×Ÿ ×‘×¨××•×Ÿ', '×˜×™×¨××™×¡×•', '×§×¨× ×‘×¨×•×œ×”', '×¤× ×§×•×˜×”', '××•×¨×– ×—×œ×‘', '×¡×”×¨×•×Ÿ', '×’×•', '××•× ×˜×”', '×§×™× ×“×¨ ×‘×•×× ×•', '×§×™× ×“×¨ ××™×œ×§', '×§×™× ×“×¨ ×”×¤×ª×¢×”'],

            deli: ['× ×§× ×™×§×™×•×ª', '× ×§× ×™×§×™×•×ª ×‘×¨×’×–', '× ×§× ×™×§×™×•×ª ×¦×œ×™×™×”', '× ×§× ×™×§ ×¤×¨× ×§×¤×•×¨×˜×¨', '×¡×œ××™', '×¡×œ××™ ×”×•× ×’×¨×™', '×¤×¡×˜×¨××”', '×¤×¡×˜×¨××” ×”×•×“×•', '×§×‘× ×•×¡', '× ×§× ×™×§ ××¢×•×©×Ÿ', '×—×–×” ×”×•×“×• ××¢×•×©×Ÿ', '×—×–×” ×”×•×“×• ×¤×¨×•×¡', '×¨×•×¡×˜×‘×™×£', '×§×•×¨× ×‘×™×£', '×©×™×¤×•×“×™×', '×©×™×¤×•×“×™ ×¢×•×£', '×©×™×¤×•×“×™ ×”×•×“×•', '×§×¦×™×¦×•×ª', '×§×¦×™×¦×•×ª ×¢×•×£', '×§×¦×™×¦×•×ª ×‘×§×¨', '×œ×‘×™×‘×•×ª', '×¤×œ××¤×œ ××•×›×Ÿ', '×—×•××•×¡ ××•×›×Ÿ', '×˜×—×™× ×” ××•×›× ×”', '×¡×œ×˜×™× ××•×›× ×™×', '×¡×œ×˜ ×—×¦×™×œ×™×', '×¡×œ×˜ ××˜×‘×•×—×”', '×¡×œ×˜ ×˜×•×¨×§×™'],

            canned: ['××•×¨×–', '××•×¨×– ×‘×¡××˜×™', '××•×¨×– ×™×¡××™×Ÿ', '××•×¨×– ××œ×', '××•×¨×– ×¡×•×©×™', '××•×¨×– ×¤×¨×¡×™', '×¤×¡×˜×”', '×¤×¡×˜×” ×¤× ×”', '×¤×¡×˜×” ×¡×¤×’×˜×™', '×¤×¡×˜×” ×¤×¨×¤×œ×”', '×¤×¡×˜×” ×¤×•×–×™×œ×™', '×¤×¡×˜×” ×œ×–× ×™×”', '×¤×¡×˜×” ××œ××”', '×§×•×¡×§×•×¡', '×§×•×¡×§×•×¡ ××œ×', '×§×•×¡×§×•×¡ ×¤×ª×™×ª×™×', '×§×˜× ×™×•×ª', '×¨×•×˜×‘ ×¢×’×‘× ×™×•×ª', '×¨×•×˜×‘ ×¤×¡×˜×”', '×¨×¡×§ ×¢×’×‘× ×™×•×ª', '×˜×•× ×”', '×˜×•× ×” ×‘××™×', '×˜×•× ×” ×‘×©××Ÿ', '×˜×•× ×” ×‘×¨×•×˜×‘', '×ª×™×¨×¡', '×ª×™×¨×¡ ××ª×•×§', '×’×¨×’×™×¨×™ ×ª×™×¨×¡', '×©××Ÿ ×–×™×ª', '×©××Ÿ ×–×™×ª ×›×ª×™×ª', '×©××Ÿ ×§× ×•×œ×”', '×©××Ÿ ×—×× ×™×•×ª', '×©××Ÿ ×ª×™×¨×¡', '×©××Ÿ ×©×•××©×•×', '×©××Ÿ ××’×•×–×™×', '×—×•××¥ ×‘×œ×¡××™', '×—×•××¥ ×™×™×Ÿ', '×—×•××¥ ×ª×¤×•×—×™×', '×—×•××¥ ×œ×‘×Ÿ', '××™×¥ ×œ×™××•×Ÿ', '×—×•××•×¡', '×—×•××•×¡ ×˜×—×•×Ÿ', '×˜×—×™× ×”', '×˜×—×™× ×” ×’×•×œ××™×ª', '×××¨×— ×©×•×', '×–×™×ª×™×', '×–×™×ª×™× ×©×—×•×¨×™×', '×–×™×ª×™× ×™×¨×•×§×™×', '×–×™×ª×™× ×§×œ××˜×”', '××œ×¤×¤×•×Ÿ ×—××•×¥', '×¤×œ×¤×œ ×—×¨×™×£', '×¤×¤×¨×™×§×” ×§×œ×•×™×”', '×¨×™×‘×”', '×¨×™×‘×” ×ª×•×ª', '×¨×™×‘×” ××©××©', '×“×‘×©', '×“×‘×© ×˜×”×•×¨', '×¡×™×œ××Ÿ', '×××¨×— ×©×•×§×•×œ×“', '×—×××ª ×‘×•×˜× ×™×', '×—×××ª ×©×§×“×™×', '×‘×•×˜× ×™×', '×©×•××©×•×', '×¤×¨×’', '×—×™×˜×”', '×‘×•×¨×’×•×œ', '×§×™× ×•××”', '×¤×¨×™×§×”', '× ×•×“×œ×¡', '××˜×¨×™×•×ª', '×¤×•×œ', '×’×¨×’×™×¨×™ ×—×•××•×¡', '×¢×“×©×™×', '×¢×“×©×™× ×›×ª×•××•×ª', '×¢×“×©×™× ×™×¨×•×§×•×ª', '×©×¢×•×¢×™×ª ×œ×‘× ×”', '×©×¢×•×¢×™×ª ××“×•××”', '×©×¢×•×¢×™×ª ×©×—×•×¨×”', '××¤×•× ×”', '×¡×•×™×”', '×××©'],

            cereals: ['×§×•×¨× ×¤×œ×§×¡', '×§×•×¨× ×¤×œ×§×¡ ×§×œ××¡×™', '×§×•×¨× ×¤×œ×§×¡ ×“×‘×©', '×§×•×¨× ×¤×œ×§×¡ ×©×•×§×•×œ×“', '×§×•×¨× ×¤×œ×§×¡ ×›×¨×™×•×ª', '×§×•×¨× ×¤×œ×§×¡ ×¤×™×¨×•×ª', '×˜×œ××” ×›×¨×™×•×ª', '×˜×¨×™×§×¡', '×¤×ª×™×ª×™ ×ª×™×¨×¡', '×’×¨× ×•×œ×”', '×’×¨× ×•×œ×” ×©×•×§×•×œ×“', '×’×¨× ×•×œ×” ×¤×™×¨×•×ª', '×’×¨× ×•×œ×” ××’×•×–×™×', '××•×–×œ×™', '×©×™×‘×•×œ×ª ×©×•×¢×œ', '×©×™×‘×•×œ×ª ×©×•×¢×œ ××”×™×¨×”', '×¤×¦×¤×•×¦×™ ××•×¨×–', '×§×•×•××§×¨', '×“×’× ×™ ×‘×•×§×¨', '×“×’× ×™× ××œ××™×', '××™× ×™ ×•×•×™×˜×¡', '×¤×¨×•×¡×˜×™×–', '×¦\'×¨×™×•×¡', '×¡×¤×™×™×©×œ K', '× ×¡×˜×œ×” ×¤×™×˜× ×¡', '×—×œ×•×•×”', '×—×œ×•×•×” ×¤×¨×•×¡×”', '×¡× ××§ ×‘×¨', '×—×˜×™×£ ×“×’× ×™×', '×—×˜×™×£ ×’×¨× ×•×œ×”'],

            spices: ['××œ×—', '××œ×— ×™×', '××œ×— ×©×•×œ×—×Ÿ', '××œ×— ×’×¡', '×¤×œ×¤×œ ×©×—×•×¨', '×¤×œ×¤×œ ×’×¨×•×¡', '×¤×¤×¨×™×§×”', '×¤×¤×¨×™×§×” ××ª×•×§×”', '×¤×¤×¨×™×§×” ×—×¨×™×¤×”', '×¤×¤×¨×™×§×” ××¢×•×©× ×ª', '×›×•×¨×›×•×', '×›××•×Ÿ', '×§×™× ××•×Ÿ', '×§×™× ××•×Ÿ ×˜×—×•×Ÿ', '××§×œ×•×ª ×§×™× ××•×Ÿ', '××‘×§×ª ×©×•×', '××‘×§×ª ×‘×¦×œ', '××•×¨×’× ×•', '×‘×–×™×œ×™×§×•×', '×–×¢×ª×¨', '×¡×•××§', '×—×•×•××™×™×’×³', '×ª×‘×œ×™×Ÿ ×œ×¢×•×£', '×ª×‘×œ×™×Ÿ ×œ×“×’×™×', '×ª×‘×œ×™×Ÿ ×œ×‘×©×¨', '×ª×‘×œ×™×Ÿ ×’×¨×™×œ', '×§××¨×™', '×’×¨× ××¡××œ×”', '×¦×™×™×œ×™', '×§×™××Ÿ', '×–× ×’×‘×™×œ', '××’×•×– ××•×¡×§×˜', '×¦×™×¤×•×¨×Ÿ', '×›×•×¡×‘×¨×” ×˜×—×•× ×”', '×§×¨×“××•×Ÿ', '×¡×•×›×¨', '×¡×•×›×¨ ×—×•×', '×¡×•×›×¨ ×“××¨×¨×”', '×¡×•×›×¨ ×•× ×™×œ', '×¡×•×›×¨×ª', '×¡×˜×™×‘×™×”', '×§××—', '×§××— ×œ×‘×Ÿ', '×§××— ××œ×', '×§××— ×ª×™×¨×¡', '×§××— ×›×•×¡××™×Ÿ', '×§××— ×©×§×“×™×', '×§×•×¨× ×¤×œ×•×¨', '×¢××™×œ×Ÿ', '×©××¨×™×', '×©××¨×™× ×™×‘×©×™×', '××‘×§×ª ××¤×™×™×”', '×¡×•×“×” ×œ×©×ª×™×™×”', '×•× ×™×œ', '×ª××¦×™×ª ×•× ×™×œ', '×©×•×§×•×œ×“ ×¦\'×™×¤×¡', '×©×•×§×•×œ×“ ××¨×™×¨ ×œ××¤×™×™×”', '×§×§××•', '××’×•×–×™×', '×©×§×“×™×', '×©×§×“×™× ×˜×—×•× ×™×', '×©×§×“×™× ×¤×¨×•×¡×™×', '××’×•×–×™ ××œ×š', '×¤×§××Ÿ', '×§×©×™×•', '×¤×™×¡×˜×•×§', '××’×•×–×™ ×œ×•×–', '×§×•×§×•×¡ ××’×•×¨×“', '×¦×™××•×§×™×', '×—××•×¦×™×•×ª', '×ª××¨×™×', '×ª××¨×™× ××’\'×”×•×œ'],

            coffee: ['×§×¤×” × ××¡', '×§×¤×” ×¢×œ×™×ª', '×§×¤×” ×’\'×§×•×‘×¡', '×§×¤×” × ×¡×§×¤×”', '×§×¤×” ×˜×•×¨×§×™', '×§×¤×” ×©×—×•×¨', '×§×¤×” × ×¡×¤×¨×¡×•', '×§×¤×” × ×˜×•×œ ×§×¤××™×Ÿ', '×§×¤×¡×•×œ×•×ª × ×¡×¤×¨×¡×•', '×§×¤×¡×•×œ×•×ª ×“×•×œ×¦\'×”', '×§×¤×¡×•×œ×•×ª ×œ×•×•××¦×”', '×§×¤×¡×•×œ×•×ª ×˜××¡×™××•', '×§×¤×¡×•×œ×•×ª ×œ× ×“×•×•×¨', '×§×¤×” ×§×œ×•×™ ×˜×—×•×Ÿ', '×§×¤×” ××¡×¤×¨×¡×•', '×ª×” ×©×—×•×¨', '×ª×” ×™×¨×•×§', '×ª×” ×™×¨×•×§ ×™×¡××™×Ÿ', '×ª×” ×¦××—×™×', '×ª×” × ×¢× ×¢', '×ª×” ×œ×•××™×–×”', '×ª×” ×œ×™×¤×˜×•×Ÿ', '×ª×” ×•×™×¡×•×¦×§×™', '×ª×” ×¤×•×§×™××•×Ÿ', '×ª×” ×§××•××™×œ', '×ª×” ××¨×•×•×”', '×ª×” ×’\'×™× ×’\'×¨', '×ª×” ×œ×™××•×Ÿ', '×ª×” ××¨×œ ×’×¨×™×™', '×ª×” ×× ×’×œ×™', '×—×œ×‘ ××¨×•×›×–', '×§×¤×” ××•×›×Ÿ', '××™×™×¡ ×§×¤×”', '×§×¤×•×¦\'×™× ×• ××•×›×Ÿ', '×§×§××• ×©×•×§×•', '××‘×§×ª ×§×§××•'],

            drinks: ['××™× ××™× ×¨×œ×™×', '××™× ×‘×˜×¢××™×', '××™ ×¢×“×Ÿ', '× ×‘×™×¢×•×ª', '××™ × ×¢×', '×§×•×œ×”', '×§×•×œ×” ×–×™×¨×•', '×§×•×œ×” ×“×™××˜', '×¤×¤×¡×™', '×¤×¤×¡×™ ××§×¡', '×¡×¤×¨×™×™×˜', '×¡×¤×¨×™×™×˜ ×–×™×¨×•', '×¤×× ×˜×”', '×©×•×•×¤×¡', '×¡×•×“×”', '×˜×•× ×™×§', '××™×¥ ×ª×¤×•×–×™×', '××™×¥ ×ª×¤×•×–×™× ×¡×—×•×˜', '××™×¥ ×ª×¤×•×—×™×', '××™×¥ ×¢× ×‘×™×', '××™×¥ ×’×–×¨', '××™×¥ ×¨×™××•× ×™×', '××™×¥ ×¤×¨×™×’×ª', '××™×¥ ×¡×¤×¨×™× ×’', '× ×§×˜×¨', '×ª×¤×•×–×™× ×”', '×œ×™××•× ×“×”', '×œ×™××•× ×¢× ×¢', 'XL ×× ×¨×’×™×”', '×¨×“ ×‘×•×œ', '××•× ×¡×˜×¨', '××©×§×” ×¡×¤×•×¨×˜', '××©×§×” ×× ×¨×’×™×”', '××©×§×” ××™×–×•×˜×•× ×™', '×§×•××‘×•×¦\'×”', '××™ ×§×•×§×•×¡', '×—×œ×‘ ×©×•×§×•×œ×“', '×—×œ×‘ ×ª×•×ª', '×—×œ×‘ ×‘× × ×”'],

            snacks: ['×‘××‘×”', '×‘××‘×” ××“×•××™×', '×‘××‘×” × ×•×’×˜', '×‘×™×¡×œ×™', '×‘×™×¡×œ×™ ×’×¨×™×œ', '×‘×™×¡×œ×™ ×‘×¦×œ', '×‘×™×¡×œ×™ ×¤×™×¦×”', '×“×•×¨×™×˜×•×¡', '×“×•×¨×™×˜×•×¡ ×¦\'×™×œ×™', '×˜×•×¨×˜×™×™×” ×¦\'×™×¤×¡', '×ª×¤×•×¦\'×™×¤×¡', '×¤×¨×™× ×’×œ×¡', '×¤×¨×™× ×’×œ×¡ ×—××•×¥', '×¤×•×¤×§×•×¨×Ÿ', '×¤×•×¤×§×•×¨×Ÿ ××™×§×¨×•', '×¤×•×¤×§×•×¨×Ÿ ×§×¨××œ', '×©×•×§×•×œ×“', '×©×•×§×•×œ×“ ×¤×¨×”', '×©×•×§×•×œ×“ ××™×œ×§×”', '×©×•×§×•×œ×“ ×—×œ×‘', '×©×•×§×•×œ×“ ××¨×™×¨', '×©×•×§×•×œ×“ ×œ×‘×Ÿ', '×©×•×§×•×œ×“ ×¢× ××’×•×–×™×', '×§×™× ×“×¨', '×¡× ×™×§×¨×¡', '×××¨×¡', '×˜×•×•×™×§×¡', '×§×™×˜×§×˜', '× ×•×˜×œ×”', '×××¨×— ×©×•×§×•×œ×“', '×‘×™×¡×§×•×•×™×˜×™×', '×¢×•×’×™×•×ª ××•×¨××•', '×¢×•×’×™×•×ª ×œ×•×˜×•×¡', '×•×•×¤×œ×™×', '×•×•×¤×œ ×‘×œ×’×™', '×§×¦×¤×ª', '××¨×©××œ×•', '×¡×•×›×¨×™×•×ª', '×¡×•×›×¨×™×•×ª ×’×•××™', '×“×•×‘×•× ×™×', '××¡×˜×™×§', '×× ×˜×•×¡', '×˜×™×§ ×˜×§', '×¢×•×’×ª ×©×•×§×•×œ×“', '×¢×•×’×ª ×’×‘×™× ×”', '×¨×•×œ×“×”', '×§×¨××‘×•', '×¤×¡×§ ×–××Ÿ', '×§×œ×™×§', '×˜×¢××™'],

            frozen: ['×’×œ×™×“×”', '×’×œ×™×“×” ×•× ×™×œ', '×’×œ×™×“×” ×©×•×§×•×œ×“', '×’×œ×™×“×” ×ª×•×ª', '×’×œ×™×“×” ×¤×™×¡×˜×•×§', '×’×œ×™×“×” ×§×¨××œ', '×’×œ×™×“×ª ×¤×¨×•×•×”', '×’×œ×™×“×” ×‘×Ÿ ×× ×“ ×’\'×¨×™', '××¨×˜×™×§', '××’× ×•×', '×§×•×¨× ×˜×•', '×©×œ×’×•×Ÿ', '×¤×™×¨×•×ª ×§×¤×•××™×', '×ª×•×ª×™× ×§×¤×•××™×', '×¤×˜×œ ×§×¤×•×', '××•×›×× ×™×•×ª ×§×¤×•××•×ª', '×× ×’×• ×§×¤×•×', '×™×¨×§×•×ª ×§×¤×•××™×', '×™×¨×§×•×ª ××•×§×¤×¦×™×', '××¤×•× ×” ×§×¤×•××”', '×ª×™×¨×¡ ×§×¤×•×', '×©×¢×•×¢×™×ª ×™×¨×•×§×” ×§×¤×•××”', '×‘×¨×•×§×•×œ×™ ×§×¤×•×', '×ª×¨×“ ×§×¤×•×', '×©× ×™×¦×œ ×§×¤×•×', '× ××’×˜×¡ ×§×¤×•××™×', '×§×¦×™×¦×•×ª ×§×¤×•××•×ª', '×”××‘×•×¨×’×¨ ×§×¤×•×', '×¤×™×¦×” ×§×¤×•××”', '×¤×™×¦×” ××©×¤×—×ª×™×ª', '×œ×–× ×™×” ×§×¤×•××”', '×‘×¦×§ ×¢×œ×™×', '×‘×¦×§ ×¤×™×œ×•', '×‘×¦×§ ×¤×™×¦×”', '×‘×¦×§ ×××¤×™×', '×‘×¦×§ ×’\'×—× ×•×Ÿ', '×‘×¦×§ ××œ×•×•×—', '×‘×¦×§ ×¡××‘×•×¡×§', '×‘×¦×§ ×‘×•×¨×§×¡', '×‘×œ×™× ×¦\'×¡', '×§×¨×¤', '×•×•×¤×œ ×§×¤×•×'],

            health: ['×™×•×’×•×¨×˜ ×™×•×•× ×™ 0%', '×™×•×’×•×¨×˜ ×—×œ×‘×•×Ÿ', '×™×•×’×•×¨×˜ ×¤×¨×•×‘×™×•×˜×™', '×§×•×˜×’\' 0%', '×§×•×˜×’\' 3%', '×’×‘×™× ×” ×œ×‘× ×” 0%', '×—×œ×‘ ×¡×•×™×”', '×—×œ×‘ ×©×§×“×™×', '×—×œ×‘ ×§×•×§×•×¡', '×—×œ×‘ ××•×¨×–', '×—×œ×‘ ×©×™×‘×•×œ×ª ×©×•×¢×œ', '×—×œ×‘ ×“×œ ×œ×§×˜×•×–', '××©×§×” ×—×œ×‘×•×Ÿ', '×©×™×™×§ ×—×œ×‘×•×Ÿ', '××‘×§×ª ×—×œ×‘×•×Ÿ', '×¤×¨×•×˜××™×Ÿ ×‘×¨', '×—×˜×™×£ ×—×œ×‘×•×Ÿ', '×—×˜×™×£ ×× ×¨×’×™×”', '×œ×—× ××œ×', '×œ×—× ×œ×œ× ×’×œ×•×˜×Ÿ', '×¤×™×ª×” ××œ××”', '×§×¨×§×¨ ×“×’× ×™×', '×§×¨×§×¨ ××•×¨×–', '×˜×•× ×” ×‘××™×', '×¡×œ×˜ ×˜×•× ×”', '×—×–×” ×¢×•×£ ××¢×•×©×Ÿ', '×’×¨× ×•×œ×” ×‘×¨×™××•×ª', '×©×™×‘×•×œ×ª ×©×•×¢×œ', '×–×¨×¢×™ ×¦\'×™×”', '×–×¨×¢×™ ×¤×©×ª×Ÿ', '×§×™× ×•××”', '××’×•×–×™× ×˜×‘×¢×™×™×', '×©×§×“×™× ×˜×‘×¢×™×™×', '×¤×™×¨×•×ª ×™×‘×©×™× ×œ×œ× ×¡×•×›×¨', '×—××•×¦×™×•×ª', '×’×•×’\'×™ ×‘×¨×™', '×¡×¤×™×¨×•×œ×™× ×”', '×•×™×˜××™× ×™×', '××•××’×” 3', '×¤×¨×•×‘×™×•×˜×™×§×”'],

            cleaning: ['× ×™×™×¨ ×˜×•××œ×˜', '× ×™×™×¨ ×˜×•××œ×˜ ×ª×œ×ª ×©×›×‘×ª×™', '××’×‘×•×ª × ×™×™×¨', '××’×‘×•×ª × ×™×™×¨ ×œ×™×“×™×™×', '×××—×˜×•×ª × ×™×™×¨', '×¡×‘×•×Ÿ ×›×œ×™×', '×¡×‘×•×Ÿ ×›×œ×™× ×¤×™×™×¨×™', '× ×•×–×œ ×›×œ×™×', '××‘×§×ª ×›×‘×™×¡×”', '××‘×§×ª ×›×‘×™×¡×” ××¨×™××œ', '×’\'×œ ×›×‘×™×¡×”', '×’\'×œ ×›×‘×™×¡×” ××¨×•×›×–', '×§×¤×¡×•×œ×•×ª ×›×‘×™×¡×”', '××¨×›×š ×›×‘×™×¡×”', '××‘×©× ×›×‘×™×¡×”', '××§×•× ×•××™×§×”', '××§×•× ×•××™×§×” ×’\'×œ', '×××™×¥ ×›×‘×™×¡×”', '×× ×§×” ×¨×¦×¤×•×ª', '×× ×§×” ×¨×¦×¤×•×ª ×¡× ×•', '×× ×§×” ×—×œ×•× ×•×ª', '×× ×§×” ×××‘×˜×™×”', '×× ×§×” ×©×™×¨×•×ª×™×', '×× ×§×” ×›×™×¨×™×™×', '×× ×§×” ×ª× ×•×¨', '×× ×§×” ×©×•×× ×™×', '××‘×§×ª × ×™×§×•×™', '×¡×™×£', '××¨ ××•×¡×§×œ', '×¡×¤×•×’×™×', '×¡×¤×•×’×™ ×¤×œ×“×”', '××˜×œ×™×•×ª ×¨×¦×¤×”', '××˜×œ×™×•×ª × ×™×§×•×™', '×©×§×™×•×ª ××©×¤×”', '×©×§×™×•×ª ××©×¤×” ×’×“×•×œ×•×ª', '×©×§×™×•×ª ××©×¤×” ×¨×™×—× ×™×•×ª', '×©×§×™×•×ª ×–×™×¤×œ×•×§', '×©×§×™×•×ª ×›×¨×™×›×™×', '×©×§×™×•×ª ×§×¤×•××™×', '× ×™×™×¨ ××¤×™×™×”', '× ×™×™×¨ ××œ×•××™× ×™×•×', '× ×™×™×œ×•×Ÿ × ×¦××“', '×˜×‘×œ×™×•×ª ×œ××“×™×—', '××œ×— ×œ××“×™×—', '× ×•×–×œ ××‘×¨×™×§ ×œ××“×™×—', '×× ×§×” ××“×™×—', '××˜×”×¨ ××•×•×™×¨', '×’×¨×™×™× ×™ ××©×¤×”'],

            hygiene: ['×¡×‘×•×Ÿ ×™×“×™×™×', '×¡×‘×•×Ÿ ×™×“×™×™× × ×•×–×œ×™', '×¡×‘×•×Ÿ ××•×¦×§', '××’×‘×•× ×™× ×œ×—×™×', '××’×‘×•× ×™× ×× ×˜×™×‘×§×˜×¨×™××œ×™×™×', '×’\'×œ ××œ×›×•×”×•×œ', '××‘×¨×©×ª ×©×™× ×™×™×', '××‘×¨×©×ª ×©×™× ×™×™× ×—×©××œ×™×ª', '×¨××©×™× ×œ××‘×¨×©×ª', '××©×—×ª ×©×™× ×™×™×', '××©×—×ª ×©×™× ×™×™× ×§×•×œ×’×™×™×˜', '××©×—×ª ×©×™× ×™×™× ×¡× ×¡×•×“×™×™×Ÿ', '××™ ×¤×”', '××™ ×¤×” ×œ×™×¡×˜×¨×™×Ÿ', '×—×•×˜ ×“× ×˜×œ×™', '×§×™×¡××™ ×©×™× ×™×™×', '×©××¤×•', '×©××¤×• ×”×“ ×× ×“ ×©×•×œ×“×¨×¡', '×©××¤×• ×¤× ×˜×Ÿ', '×©××¤×• ×œ×©×™×¢×¨ ×™×‘×©', '×©××¤×• ×œ×©×™×¢×¨ ×©××Ÿ', '×©××¤×• × ×’×“ ×§×©×§×©×™×', '××¨×›×š ×©×™×¢×¨', '××¡×›×” ×œ×©×™×¢×¨', '×¡×¨×•× ×œ×©×™×¢×¨', '×¡×¤×¨×™×™ ×œ×©×™×¢×¨', '×’\'×œ ×œ×©×™×¢×¨', '×§×¦×£ ×œ×©×™×¢×¨', '×©××¤×• ×œ×™×œ×“×™×', '×¡×‘×•×Ÿ ×’×•×£', '×’\'×œ ×¨×—×¦×”', '×’\'×œ ×¨×—×¦×” × ×™×•×•××”', '×§×¨× ×’×™×œ×•×—', '×’\'×œ ×’×™×œ×•×—', '×¡×›×™× ×™ ×’×™×œ×•×—', '×¡×›×™× ×™ ×’×™×œ×•×— ×’\'×™×œ×˜', '×“××•×“×•×¨× ×˜', '×“××•×“×•×¨× ×˜ ×¨×•×œ ××•×Ÿ', '×“××•×“×•×¨× ×˜ ×¡×¤×¨×™×™', '×× ×˜×™×¤×¨×¡×¤×™×¨× ×˜', '×§×¨× ×¤× ×™×', '×§×¨× ×œ×—×•×ª', '×§×¨× ×™×“×™×™×', '×§×¨× ×’×•×£', '×§×¨× ×¨×’×œ×™×™×', '×©××Ÿ ×’×•×£', '×œ×•×¡×™×•×Ÿ ×’×•×£', '×ª×—×‘×•×©×•×ª', '×¤×œ×¡×˜×¨×™×”', '×¦××¨ ×’×¤×Ÿ', '××§×œ×•× ×™ ××•×–× ×™×™×', '×˜××¤×•× ×™×', '××’× ×™ ×ª×—×ª×•×Ÿ', '×ª×—×‘×•×©×•×ª ×™×•×', '×ª×—×‘×•×©×•×ª ×œ×™×œ×”', '×§×¨× ×”×’× ×”', '×§×¨× ×©×™×–×•×£', '××¤×˜×¨ ×¡××Ÿ', '××¡×™×¨ ××™×¤×•×¨', '××’×‘×•× ×™× ×œ×”×¡×¨×ª ××™×¤×•×¨', '×ª×¡×¤×•×¨×ª ×—×“ ×¤×¢××™×ª'],

            candles: ['× ×¨×•×ª ×©×‘×ª', '× ×¨×•×ª ×©×‘×ª ×œ×‘× ×™×', '× ×¨×•×ª ×©×‘×ª ×¦×‘×¢×•× ×™×™×', '× ×¨×•×ª ×—× ×•×›×”', '× ×¨×•×ª ×—× ×•×›×” ×¦×‘×¢×•× ×™×™×', '× ×¨ × ×©××” 24 ×©×¢×•×ª', '× ×¨ × ×©××” 48 ×©×¢×•×ª', '× ×¨ × ×©××” 7 ×™××™×', '× ×¨ ×”×‘×“×œ×”', '× ×¨×•×ª ×™×•× ×”×•×œ×“×ª', '× ×¨×•×ª ×¨×™×—× ×™×™×', '× ×¨×•×ª ×“×§×•×¨×˜×™×‘×™×™×', '×©××Ÿ ×œ× ×¨', '×©××Ÿ ×¤×¨×¤×™×Ÿ', '×©××Ÿ ×–×™×ª ×œ× ×¨', '×¤×ª×™×œ×•×ª', '×’×¤×¨×•×¨×™×', '××¦×™×ª×™×'],

            baby: ['×—×™×ª×•×œ×™×', '×—×™×ª×•×œ×™× ×¤××¤×¨×¡', '×—×™×ª×•×œ×™× ×”××’×™×¡', '×—×™×ª×•×œ×™× ××™×“×” 1', '×—×™×ª×•×œ×™× ××™×“×” 2', '×—×™×ª×•×œ×™× ××™×“×” 3', '×—×™×ª×•×œ×™× ××™×“×” 4', '×—×™×ª×•×œ×™× ××™×“×” 5', '××›× ×¡×•× ×™ ×—×™×ª×•×œ', '×—×™×ª×•×œ×™ ×œ×™×œ×”', '××’×‘×•× ×™× ×œ×ª×™× ×•×§×•×ª', '××’×‘×•× ×™× ×¤××¤×¨×¡', '××’×‘×•× ×™× ×¨×’×™×©×™×', '×©××¤×• ×œ×ª×™× ×•×§×•×ª', '×¡×‘×•×Ÿ ×œ×ª×™× ×•×§×•×ª', '××œ ×¡×‘×•×Ÿ ×œ×ª×™× ×•×§×•×ª', '×§×¨× ×”×—×ª×œ×”', '×§×¨× ×¤×•×©', '×§×¨× ×“×¡×™×˜×™×Ÿ', '××©×—×ª ×”×—×ª×œ×”', '××‘×§×ª ×ª×™× ×•×§×•×ª', '×©××Ÿ ×ª×™× ×•×§×•×ª', '×§×¨× ×¤× ×™× ×œ×ª×™× ×•×§', '××‘×§×ª ×—×œ×‘', '××‘×§×ª ×—×œ×‘ ×¡×™××™×œ××§', '××‘×§×ª ×—×œ×‘ ××˜×¨× ×”', '××–×•×Ÿ ×œ×ª×™× ×•×§×•×ª', '××—×™×ª ×¤×™×¨×•×ª', '××—×™×ª ×™×¨×§×•×ª', '×“×™×™×¡×” ×œ×ª×™× ×•×§×•×ª', '×‘×™×¡×œ×™ ×œ×ª×™× ×•×§×•×ª', '×—×˜×™×£ ×ª×™× ×•×§×•×ª', '××™×¥ ×œ×ª×™× ×•×§×•×ª', '××•×¦×¦×™×', '××•×¦×¥ ××•×•× ×˜', '×‘×§×‘×•×§ ×ª×™× ×•×§', '×‘×§×‘×•×§ ××•×•× ×˜', '×¤×˜××•×ª', '××‘×¨×©×ª ×©×™× ×™×™× ×œ×ª×™× ×•×§', '××©×—×ª ×©×™× ×™×™× ×œ×ª×™× ×•×§', '×©××¤×• ×™×œ×“×™×', '×¡×‘×•×Ÿ ×™×œ×“×™×'],

            pets: ['××–×•×Ÿ ×œ×›×œ×‘×™×', '××–×•×Ÿ ×™×‘×© ×œ×›×œ×‘×™×', '××–×•×Ÿ ×¨×˜×•×‘ ×œ×›×œ×‘×™×', '××–×•×Ÿ ×œ×›×œ×‘×™× ×‘×•×’×¨×™×', '××–×•×Ÿ ×œ×’×•×¨×™×', '××–×•×Ÿ ×œ×—×ª×•×œ×™×', '××–×•×Ÿ ×™×‘×© ×œ×—×ª×•×œ×™×', '××–×•×Ÿ ×¨×˜×•×‘ ×œ×—×ª×•×œ×™×', '××–×•×Ÿ ×œ×—×ª×•×œ×™× ×‘×•×’×¨×™×', '××–×•×Ÿ ×œ×’×•×¨×™ ×—×ª×•×œ×™×', '×—×•×œ ×œ×—×ª×•×œ×™×', '×—×•×œ ××ª×’×‘×©', '×—×•×œ ×¡×™×œ×™×§×”', '×—×˜×™×¤×™× ×œ×›×œ×‘×™×', '×—×˜×™×¤×™× ×œ×—×ª×•×œ×™×', '×¢×¦××•×ª ×œ×›×¢×™×¡×”', '×“× ×˜×¡×˜×™×§×¡', '×¦×¢×¦×•×¢×™× ×œ×›×œ×‘×™×', '×¦×¢×¦×•×¢×™× ×œ×—×ª×•×œ×™×', '××™×˜×” ×œ×›×œ×‘', '××™×˜×” ×œ×—×ª×•×œ', '×§×¢×¨×ª ××•×›×œ', '×§×¢×¨×ª ××™×', '×¨×¦×•×¢×” ×œ×›×œ×‘', '×§×•×œ×¨', '××¡×¨×§ ×œ×›×œ×‘', '×©××¤×• ×œ×›×œ×‘×™×', '×©×§×™×•×ª ×§×§×™', '××©×˜×— ××™××•×Ÿ', '××–×•×Ÿ ×œ×“×’×™×', '××–×•×Ÿ ×œ×¦×™×¤×•×¨×™×', '××–×•×Ÿ ×œ××•×’×¨×™×']
        };

        function ShoppingList() {
            const { user } = useAuth();
            const { family, lists, currentList, setCurrentList, logActivity } = useFamily();
            const [items, setItems] = useState([]);
            const [selectedCategory, setSelectedCategory] = useState(null);
            const [searchTerm, setSearchTerm] = useState('');
            const [loading, setLoading] = useState(true);
            const [darkMode, setDarkMode] = useState(false);
            const [showFinishShopping, setShowFinishShopping] = useState(false);
            const [showHistory, setShowHistory] = useState(false);
            const [totalAmount, setTotalAmount] = useState('');
            const [history, setHistory] = useState([]);
            const [showDeleteConfirm, setShowDeleteConfirm] = useState(null);
            const [showFamilySettings, setShowFamilySettings] = useState(false);
            const [showCreateList, setShowCreateList] = useState(false);
            const [showActivityFeed, setShowActivityFeed] = useState(false);
            const [editingNote, setEditingNote] = useState(null);

            useEffect(() => {
                const savedDark = localStorage.getItem('darkMode') === 'true';
                if (savedDark) {
                    setDarkMode(true);
                    document.documentElement.classList.add('dark');
                }
            }, []);

            useEffect(() => {
                if (!family || !currentList) {
                    setItems([]);
                    setLoading(false);
                    return;
                }

                const q = window.firestore.query(
                    window.firestore.collection(window.db, 'shopping-items'),
                    window.firestore.where('familyId', '==', family.id),
                    window.firestore.where('listId', '==', currentList.id)
                );

                const unsubscribe = window.firestore.onSnapshot(
                    q,
                    (snapshot) => {
                        const itemsData = [];
                        snapshot.forEach((doc) => {
                            itemsData.push({ id: doc.id, ...doc.data() });
                        });
                        // Sort client-side (newest first)
                        itemsData.sort((a, b) => {
                            const dateA = a.createdAt?.toDate?.() || new Date(0);
                            const dateB = b.createdAt?.toDate?.() || new Date(0);
                            return dateB - dateA;
                        });
                        setItems(itemsData);
                        setLoading(false);
                    },
                    (error) => {
                        console.error('×©×’×™××” ×‘×˜×¢×™× ×ª × ×ª×•× ×™×:', error);
                        setLoading(false);
                    }
                );

                loadHistory();
                return () => unsubscribe();
            }, [family, currentList]);

            const loadHistory = async () => {
                if (!family) return;
                try {
                    const historyQuery = window.firestore.query(
                        window.firestore.collection(window.db, 'shopping-history'),
                        window.firestore.where('familyId', '==', family.id)
                    );
                    const snapshot = await window.firestore.getDocs(historyQuery);
                    const historyData = [];
                    snapshot.forEach(doc => {
                        historyData.push({ id: doc.id, ...doc.data() });
                    });
                    // Sort client-side (newest first)
                    historyData.sort((a, b) => {
                        const dateA = a.completedAt?.toDate?.() || new Date(0);
                        const dateB = b.completedAt?.toDate?.() || new Date(0);
                        return dateB - dateA;
                    });
                    setHistory(historyData);
                } catch (error) {
                    console.error('×©×’×™××” ×‘×˜×¢×™× ×ª ×”×™×¡×˜×•×¨×™×”:', error);
                }
            };

            const handleLogout = async () => {
                try {
                    await window.firebaseAuth.signOut(window.auth);
                } catch (error) {
                    console.error('×©×’×™××” ×‘×”×ª× ×ª×§×•×ª:', error);
                }
            };

            const toggleDarkMode = () => {
                const newMode = !darkMode;
                setDarkMode(newMode);
                localStorage.setItem('darkMode', String(newMode));
                document.documentElement.classList.toggle('dark');
            };

            const addProduct = async (product) => {
                try {
                    const category = selectedCategory || Object.keys(PRODUCTS).find(cat => PRODUCTS[cat].includes(product));
                    const existing = items.find(item => item.name === product && !item.purchased);

                    if (existing) {
                        await window.firestore.updateDoc(
                            window.firestore.doc(window.db, 'shopping-items', existing.id),
                            {
                                quantity: existing.quantity + 1,
                                updatedAt: new Date(),
                                updatedBy: user.displayName || user.email
                            }
                        );
                        await logActivity('quantity_changed', { itemName: product });
                    } else {
                        await window.firestore.addDoc(window.firestore.collection(window.db, 'shopping-items'), {
                            name: product,
                            category: category,
                            quantity: 1,
                            purchased: false,
                            familyId: family.id,
                            listId: currentList.id,
                            addedBy: user.displayName || user.email,
                            addedByUid: user.uid,
                            note: '',
                            createdAt: new Date()
                        });
                        await logActivity('item_added', { itemName: product });
                    }
                    setSearchTerm('');
                } catch (error) {
                    console.error('×©×’×™××” ×‘×”×•×¡×¤×ª ××•×¦×¨:', error);
                    alert('×©×’×™××” ×‘×”×•×¡×¤×ª ×”××•×¦×¨. × ×¡×” ×©×•×‘.');
                }
            };

            const togglePurchased = async (id, currentStatus) => {
                try {
                    const item = items.find(i => i.id === id);
                    await window.firestore.updateDoc(window.firestore.doc(window.db, 'shopping-items', id), {
                        purchased: !currentStatus,
                        purchasedBy: !currentStatus ? (user.displayName || user.email) : null,
                        purchasedAt: !currentStatus ? new Date() : null
                    });
                    if (!currentStatus && item) {
                        await logActivity('item_purchased', { itemName: item.name });
                    }
                } catch (error) {
                    console.error('×©×’×™××” ×‘×¢×“×›×•×Ÿ ××•×¦×¨:', error);
                }
            };

            const updateQuantity = async (id, newQuantity) => {
                try {
                    if (newQuantity < 1) {
                        setShowDeleteConfirm(id);
                    } else {
                        const item = items.find(i => i.id === id);
                        await window.firestore.updateDoc(window.firestore.doc(window.db, 'shopping-items', id), {
                            quantity: newQuantity,
                            updatedAt: new Date(),
                            updatedBy: user.displayName || user.email
                        });
                        if (item) {
                            await logActivity('quantity_changed', { itemName: item.name });
                        }
                    }
                } catch (error) {
                    console.error('×©×’×™××” ×‘×¢×“×›×•×Ÿ ×›××•×ª:', error);
                }
            };

            const deleteItem = async (id) => {
                try {
                    const item = items.find(i => i.id === id);
                    await window.firestore.deleteDoc(window.firestore.doc(window.db, 'shopping-items', id));
                    setShowDeleteConfirm(null);
                    if (item) {
                        await logActivity('item_deleted', { itemName: item.name });
                    }
                } catch (error) {
                    console.error('×©×’×™××” ×‘××—×™×§×ª ××•×¦×¨:', error);
                }
            };

            const updateItemNote = async (itemId, note) => {
                try {
                    const item = items.find(i => i.id === itemId);
                    await window.firestore.updateDoc(window.firestore.doc(window.db, 'shopping-items', itemId), {
                        note: note,
                        updatedAt: new Date(),
                        updatedBy: user.displayName || user.email
                    });
                    if (item && note) {
                        await logActivity('note_added', { itemName: item.name });
                    }
                } catch (error) {
                    console.error('×©×’×™××” ×‘×¢×“×›×•×Ÿ ×”×¢×¨×”:', error);
                }
            };

            const finishShopping = async () => {
                if (!totalAmount || parseFloat(totalAmount) <= 0) {
                    alert('× × ×œ×”×–×™×Ÿ ×¡×›×•× ×ª×§×™×Ÿ');
                    return;
                }

                const purchasedItems = items.filter(item => item.purchased);
                if (purchasedItems.length === 0) {
                    alert('×œ× × ×‘×—×¨×• ××•×¦×¨×™× ×©× ×§× ×•');
                    return;
                }

                try {
                    await window.firestore.addDoc(window.firestore.collection(window.db, 'shopping-history'), {
                        items: purchasedItems,
                        totalAmount: parseFloat(totalAmount),
                        completedAt: new Date(),
                        completedBy: user.displayName || user.email,
                        completedByUid: user.uid,
                        familyId: family.id,
                        listId: currentList.id
                    });

                    for (const item of purchasedItems) {
                        await window.firestore.deleteDoc(window.firestore.doc(window.db, 'shopping-items', item.id));
                    }

                    setShowFinishShopping(false);
                    setTotalAmount('');
                    loadHistory();
                } catch (error) {
                    console.error('×©×’×™××” ×‘×¡×™×•× ×§× ×™×™×”:', error);
                    alert('×©×’×™××” ×‘×©××™×¨×ª ×”×§× ×™×™×”. × ×¡×” ×©×•×‘.');
                }
            };

            const exportToWhatsApp = () => {
                const unpurchased = items.filter(item => !item.purchased);
                let text = 'ğŸ›’ ×¨×©×™××ª ×§× ×™×•×ª:\n\n';
                Object.entries(CATEGORIES).forEach(([key, cat]) => {
                    const categoryItems = unpurchased.filter(item => item.category === key);
                    if (categoryItems.length > 0) {
                        text += `${cat.icon} ${cat.name}:\n`;
                        categoryItems.forEach(item => {
                            text += `  âœ“ ${item.name} (${item.quantity})\n`;
                        });
                        text += '\n';
                    }
                });
                window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
            };

            if (loading) {
                return (
                    <div className="min-h-screen gradient-bg flex items-center justify-center">
                        <div className="text-center">
                            <div className="text-6xl mb-4 float">ğŸ›’</div>
                            <div className="text-xl text-white font-medium">×˜×•×¢×Ÿ...</div>
                            <div className="mt-4 w-32 h-1 bg-white/20 rounded-full overflow-hidden mx-auto">
                                <div className="h-full w-1/2 progress-animate rounded-full"></div>
                            </div>
                        </div>
                    </div>
                );
            }

            const filteredItems = items;
            const groupedItems = filteredItems.reduce((acc, item) => {
                if (!acc[item.category]) acc[item.category] = [];
                acc[item.category].push(item);
                return acc;
            }, {});

            const totalItems = items.reduce((sum, item) => sum + item.quantity, 0);
            const purchasedCount = items.filter(item => item.purchased).reduce((sum, item) => sum + item.quantity, 0);

            return (
                <div className="min-h-screen gradient-bg p-4 pb-20">

                    {showDeleteConfirm && (
                        <div className="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4">
                            <div className="glass rounded-3xl p-8 max-w-sm w-full shadow-2xl">
                                <div className="text-5xl text-center mb-4">ğŸ—‘ï¸</div>
                                <h2 className="text-xl font-bold text-center text-gradient mb-2">××—×™×§×ª ××•×¦×¨</h2>
                                <p className="text-gray-600 dark:text-gray-300 mb-6 text-center">×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ××—×•×§ ××•×¦×¨ ×–×”?</p>
                                <div className="flex gap-3">
                                    <button onClick={() => deleteItem(showDeleteConfirm)}
                                        className="flex-1 bg-gradient-to-r from-red-500 to-pink-500 text-white px-6 py-3 rounded-xl hover:shadow-lg hover:scale-105 font-semibold transition-all">
                                        ××—×§
                                    </button>
                                    <button onClick={() => setShowDeleteConfirm(null)}
                                        className="flex-1 px-6 py-3 glass border-2 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 hover:scale-105 transition-all">
                                        ×‘×™×˜×•×œ
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {showFinishShopping && (
                        <div className="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4">
                            <div className="glass rounded-3xl p-8 max-w-md w-full shadow-2xl">
                                <div className="text-5xl text-center mb-4">âœ…</div>
                                <h2 className="text-2xl font-bold text-center text-gradient mb-2">×¡×™×•× ×§× ×™×™×”</h2>
                                <p className="text-gray-600 dark:text-gray-300 mb-6 text-center">× ×§× ×• <span className="font-bold text-indigo-600">{purchasedCount}</span> ×¤×¨×™×˜×™×</p>
                                <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">××” ×”×™×” ×”×¡×›×•× ×”×›×•×œ×œ? â‚ª</label>
                                <input
                                    type="number"
                                    value={totalAmount}
                                    onChange={e => setTotalAmount(e.target.value)}
                                    placeholder="0"
                                    className="w-full px-5 py-4 border-2 border-indigo-200 dark:border-indigo-600 rounded-xl bg-white/50 dark:bg-gray-700/50 dark:text-white text-xl mb-6 focus:border-indigo-500 focus:ring-4 focus:ring-indigo-100 transition-all"
                                    autoFocus
                                />
                                <div className="flex gap-3">
                                    <button onClick={finishShopping}
                                        className="flex-1 bg-gradient-to-r from-green-500 to-emerald-500 text-white px-6 py-3 rounded-xl hover:shadow-lg hover:scale-105 font-semibold transition-all">
                                        âœ“ ×¡×™×™× ×•×©××•×¨
                                    </button>
                                    <button onClick={() => { setShowFinishShopping(false); setTotalAmount(''); }}
                                        className="px-6 py-3 glass border-2 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 hover:scale-105 transition-all">
                                        ×‘×™×˜×•×œ
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {showHistory && (
                        <div className="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 overflow-y-auto">
                            <div className="glass rounded-3xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-2xl scrollbar-thin">
                                <div className="flex justify-between items-center mb-6">
                                    <h2 className="text-2xl font-bold flex items-center gap-3">
                                        <span className="text-3xl">ğŸ“Š</span>
                                        <span className="text-gradient">×”×™×¡×˜×•×¨×™×™×ª ×§× ×™×•×ª</span>
                                    </h2>
                                    <button onClick={() => setShowHistory(false)}
                                        className="w-10 h-10 flex items-center justify-center glass rounded-full text-gray-500 hover:text-red-500 dark:hover:text-red-400 text-2xl hover:scale-110 hover:rotate-90 transition-all">Ã—</button>
                                </div>
                                {history.length === 0 ? (
                                    <div className="text-center py-12">
                                        <div className="text-7xl mb-4 float">ğŸ“­</div>
                                        <p className="text-xl text-gradient font-bold mb-2">××™×Ÿ ×”×™×¡×˜×•×¨×™×” ×¢×“×™×™×Ÿ</p>
                                        <p className="text-gray-500 dark:text-gray-400">×¡×™×™××• ×§× ×™×™×” ×¨××©×•× ×” ×œ×¨××•×ª ×¡×˜×˜×™×¡×˜×™×§×”</p>
                                    </div>
                                ) : (
                                    <div className="space-y-4">
                                        {history.map((record) => (
                                            <div key={record.id} className="glass rounded-xl p-5 card-hover border border-gray-200/50 dark:border-gray-600/50">
                                                <div className="flex justify-between items-start mb-3">
                                                    <div>
                                                        <div className="text-sm text-gray-600 dark:text-gray-400 font-semibold flex items-center gap-2">
                                                            <span className="text-lg">ğŸ“…</span>
                                                            {record.completedAt?.toDate?.()?.toLocaleDateString('he-IL', {
                                                                year: 'numeric',
                                                                month: 'long',
                                                                day: 'numeric',
                                                                weekday: 'long'
                                                            }) || '×ª××¨×™×š ×œ× ×™×“×•×¢'}
                                                        </div>
                                                        <div className="text-xs text-gray-500 dark:text-gray-500 mt-1">ğŸ‘¤ {record.completedBy}</div>
                                                    </div>
                                                    <div className="text-2xl font-bold bg-gradient-to-r from-green-500 to-emerald-500 bg-clip-text text-transparent">
                                                        â‚ª{record.totalAmount.toFixed(2)}
                                                    </div>
                                                </div>
                                                <div className="text-sm text-gray-700 dark:text-gray-300 bg-indigo-50/50 dark:bg-indigo-900/20 rounded-lg p-3">
                                                    ğŸ›’ {record.items.length} ×¤×¨×™×˜×™× â€¢ ×××•×¦×¢: â‚ª{(record.totalAmount / record.items.length).toFixed(2)} ×œ×¤×¨×™×˜
                                                </div>
                                            </div>
                                        ))}
                                        <div className="glass rounded-xl p-5 border-2 border-indigo-200/50 dark:border-indigo-700/50">
                                            <h3 className="font-bold text-gradient mb-4 flex items-center gap-2">
                                                <span className="text-xl">ğŸ“ˆ</span>
                                                ×¡×˜×˜×™×¡×˜×™×§×” ×›×œ×œ×™×ª
                                            </h3>
                                            <div className="space-y-3">
                                                <div className="flex justify-between text-gray-700 dark:text-gray-300 bg-gray-50/50 dark:bg-gray-800/50 p-3 rounded-lg">
                                                    <span>×¡×”"×› ×§× ×™×•×ª:</span>
                                                    <span className="font-bold text-lg">{history.length}</span>
                                                </div>
                                                <div className="flex justify-between text-gray-700 dark:text-gray-300 bg-green-50/50 dark:bg-green-900/20 p-3 rounded-lg">
                                                    <span>×¡×”"×› ×”×•×¦××•×ª:</span>
                                                    <span className="font-bold text-lg text-green-600 dark:text-green-400">
                                                        â‚ª{history.reduce((sum, h) => sum + h.totalAmount, 0).toFixed(2)}
                                                    </span>
                                                </div>
                                                <div className="flex justify-between text-gray-700 dark:text-gray-300 bg-blue-50/50 dark:bg-blue-900/20 p-3 rounded-lg">
                                                    <span>×××•×¦×¢ ×œ×§× ×™×™×”:</span>
                                                    <span className="font-bold text-lg text-blue-600 dark:text-blue-400">
                                                        â‚ª{(history.reduce((sum, h) => sum + h.totalAmount, 0) / history.length).toFixed(2)}
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>
                    )}

                    {showFamilySettings && <FamilySettingsModal onClose={() => setShowFamilySettings(false)} />}
                    {showCreateList && <CreateListModal onClose={() => setShowCreateList(false)} />}
                    {showActivityFeed && <ActivityFeedModal onClose={() => setShowActivityFeed(false)} />}
                    {editingNote && <ItemNoteModal item={editingNote} onClose={() => setEditingNote(null)} onSave={(note) => updateItemNote(editingNote.id, note)} />}

                    <div className="max-w-4xl mx-auto">
                        <div className="glass rounded-3xl shadow-xl p-6 mb-6 relative overflow-hidden">
                            <div className="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500"></div>
                            <div className="flex items-center justify-between mb-4">
                                <div className="flex items-center gap-4">
                                    <div className="w-14 h-14 rounded-2xl btn-gradient flex items-center justify-center shadow-lg">
                                        <span className="text-3xl">ğŸ›’</span>
                                    </div>
                                    <div>
                                        <h1 className="text-2xl font-bold text-gradient">ShopSmart</h1>
                                        <div className="flex items-center gap-2 mt-1 flex-wrap">
                                            <button onClick={() => setShowFamilySettings(true)} className="px-3 py-1 rounded-full text-sm font-medium bg-gradient-to-r from-indigo-100 to-purple-100 text-indigo-700 dark:from-indigo-900/50 dark:to-purple-900/50 dark:text-indigo-300 hover:scale-105 transition-transform cursor-pointer">
                                                ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ {family?.name}
                                            </button>
                                            <span className="px-2 py-1 rounded-full text-xs bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300">
                                                ğŸ‘¤ {user.displayName || user.email}
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <div className="flex items-center gap-2">
                                    <button onClick={() => setShowActivityFeed(true)} className="w-10 h-10 rounded-xl bg-amber-100 dark:bg-amber-900/50 flex items-center justify-center text-lg hover:scale-110 transition-transform" title="×¤×¢×™×œ×•×ª">ğŸ“Š</button>
                                    <button onClick={toggleDarkMode} className="w-10 h-10 rounded-xl bg-gray-100 dark:bg-gray-700 flex items-center justify-center text-lg hover:scale-110 transition-transform">{darkMode ? 'â˜€ï¸' : 'ğŸŒ™'}</button>
                                    <button onClick={handleLogout} className="w-10 h-10 rounded-xl bg-red-100 dark:bg-red-900/50 flex items-center justify-center text-lg hover:scale-110 transition-transform text-red-600 dark:text-red-400" title="×”×ª× ×ª×§">ğŸšª</button>
                                </div>
                            </div>

                            {/* List Selector */}
                            <div className="flex items-center gap-2 mb-4 overflow-x-auto pb-2 scrollbar-thin">
                                {lists.map(list => (
                                    <button
                                        key={list.id}
                                        onClick={() => setCurrentList(list)}
                                        className={`flex items-center gap-2 px-4 py-2 rounded-xl whitespace-nowrap transition-all ${
                                            currentList?.id === list.id
                                                ? 'btn-gradient text-white shadow-lg'
                                                : 'bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200'
                                        }`}
                                    >
                                        <span>{list.icon}</span>
                                        <span className="font-medium">{list.name}</span>
                                        {list.isDefault && <span className="text-xs">â­</span>}
                                    </button>
                                ))}
                                <button
                                    onClick={() => setShowCreateList(true)}
                                    className="flex items-center gap-2 px-4 py-2 rounded-xl bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 hover:bg-indigo-100 dark:hover:bg-indigo-900/50 transition-all whitespace-nowrap"
                                >
                                    <span>â•</span>
                                    <span className="font-medium">×¨×©×™××” ×—×“×©×”</span>
                                </button>
                            </div>

                            <div className="flex items-center justify-between mb-4">
                                <div className="text-sm text-gray-500 dark:text-gray-400">
                                    {currentList?.icon} {currentList?.name}
                                </div>
                                <button
                                    onClick={() => document.getElementById('shopping-list-section')?.scrollIntoView({ behavior: 'smooth' })}
                                    className="flex items-center gap-2 px-4 py-2 bg-gradient-to-br from-indigo-50 to-purple-50 dark:from-indigo-900/30 dark:to-purple-900/30 rounded-xl hover:shadow-lg transition-all border border-indigo-200/50 dark:border-indigo-700/50">
                                    <span className="text-xs text-gray-500 dark:text-gray-400 font-medium">×¤×¨×™×˜×™×</span>
                                    <span className="text-xl font-bold text-gradient">{totalItems}</span>
                                </button>
                            </div>

                            {totalItems > 0 && (
                                <div className="bg-gradient-to-r from-indigo-500/10 to-purple-500/10 dark:from-indigo-500/20 dark:to-purple-500/20 rounded-2xl p-4 mb-4">
                                    <div className="flex justify-between mb-2 text-sm">
                                        <span className="text-gray-600 dark:text-gray-300 font-medium">×”×ª×§×“××•×ª ×§× ×™×™×”</span>
                                        <span className="font-bold text-gradient">{purchasedCount} / {totalItems}</span>
                                    </div>
                                    <div className="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 overflow-hidden">
                                        <div className="progress-animate h-2.5 rounded-full transition-all duration-700 ease-out"
                                            style={{ width: `${totalItems > 0 ? (purchasedCount / totalItems) * 100 : 0}%` }} />
                                    </div>
                                    {purchasedCount === totalItems && totalItems > 0 && (
                                        <div className="text-center mt-2 text-sm text-green-600 dark:text-green-400 font-medium">ğŸ‰ ×›×œ ×”××•×¦×¨×™× × ×§× ×•!</div>
                                    )}
                                </div>
                            )}

                            <div className="grid grid-cols-2 gap-3">
                                <button onClick={() => purchasedCount > 0 ? setShowFinishShopping(true) : alert('××™×Ÿ ××•×¦×¨×™× ×©× ×§× ×• ×¢×“×™×™×Ÿ. ×¡××Ÿ ××•×¦×¨×™× ×©×§× ×™×ª.')}
                                    className="relative overflow-hidden bg-gradient-to-br from-emerald-50 to-green-100 dark:from-emerald-900/30 dark:to-green-900/30 p-4 rounded-2xl border border-emerald-200/50 dark:border-emerald-700/50 card-hover group">
                                    <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-700"></div>
                                    <div className="text-sm text-gray-600 dark:text-gray-400 font-medium">×¡×™×™× ×§× ×™×™×”</div>
                                    <div className="text-3xl my-1">âœ…</div>
                                    {purchasedCount > 0 ? (
                                        <div className="text-xs text-emerald-600 dark:text-emerald-400 font-semibold">{purchasedCount} ×¤×¨×™×˜×™× × ×§× ×•</div>
                                    ) : (
                                        <div className="text-xs text-gray-400 dark:text-gray-500">×¡××Ÿ ××•×¦×¨×™× ×©×§× ×™×ª</div>
                                    )}
                                </button>
                                <button onClick={() => setShowHistory(true)}
                                    className="relative overflow-hidden bg-gradient-to-br from-purple-50 to-pink-100 dark:from-purple-900/30 dark:to-pink-900/30 p-4 rounded-2xl border border-purple-200/50 dark:border-purple-700/50 card-hover group">
                                    <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-700"></div>
                                    <div className="text-sm text-gray-600 dark:text-gray-400 font-medium">×”×™×¡×˜×•×¨×™×”</div>
                                    <div className="text-3xl my-1">ğŸ“Š</div>
                                    <div className="text-xs text-purple-600 dark:text-purple-400 font-semibold">{history.length} ×§× ×™×•×ª</div>
                                </button>
                            </div>

                            {items.filter(item => !item.purchased).length > 0 && (
                                <div className="mt-4">
                                    <button onClick={exportToWhatsApp}
                                        className="w-full bg-gradient-to-r from-green-500 to-emerald-500 text-white px-4 py-3 rounded-lg hover:from-green-600 hover:to-emerald-600 transition-all font-semibold shadow-lg hover:shadow-xl hover:scale-105">
                                        ğŸ“± ×©×ª×£ ×¨×©×™××” ×‘-WhatsApp
                                    </button>
                                </div>
                            )}
                        </div>

                        <div className="glass rounded-2xl shadow-xl p-4 mb-6 card-hover">
                            <div className="relative">
                                <input type="text" value={searchTerm} onChange={e => setSearchTerm(e.target.value)}
                                    placeholder="ğŸ” ×—×¤×© ××•×¦×¨ ×œ×”×•×¡×¤×”..."
                                    className="w-full px-5 py-4 pl-14 border-2 border-indigo-200 dark:border-indigo-600 rounded-2xl bg-white/50 dark:bg-gray-800/50 dark:text-white focus:border-indigo-500 dark:focus:border-indigo-400 focus:ring-4 focus:ring-indigo-100 dark:focus:ring-indigo-900/30 transition-all text-lg font-medium placeholder:text-gray-400" />
                                {searchTerm && (
                                    <button onClick={() => setSearchTerm('')}
                                        className="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-red-500 dark:hover:text-red-400 text-2xl hover:scale-125 hover:rotate-90 transition-all duration-300">
                                        âœ•
                                    </button>
                                )}
                            </div>
                        </div>

                        {searchTerm && (
                            <div className="glass rounded-2xl shadow-xl p-6 mb-6 card-hover">
                                <div className="flex justify-between items-center mb-4">
                                    <h2 className="text-xl font-bold dark:text-white flex items-center gap-2">
                                        <span className="text-2xl">ğŸ”</span>
                                        <span className="text-gradient">×ª×•×¦××•×ª ×—×™×¤×•×©</span>
                                    </h2>
                                    <button onClick={() => setSearchTerm('')} className="btn-gradient text-white text-sm px-4 py-2 rounded-full font-medium hover:shadow-lg hover:scale-105 transition-all">× ×§×” ×—×™×¤×•×© âœ•</button>
                                </div>
                                <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3">
                                    {Object.entries(PRODUCTS).flatMap(([category, products]) =>
                                        products
                                            .filter(product => product.includes(searchTerm))
                                            .map((product, idx) => (
                                                <button key={`${category}-${idx}`} onClick={() => { addProduct(product); setSelectedCategory(category); }}
                                                    className="relative bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/30 dark:to-emerald-900/30 p-4 rounded-xl font-medium text-sm border-2 border-green-200 dark:border-green-700 hover:shadow-lg hover:scale-105 transition-all dark:text-white group">
                                                    <div className="text-3xl mb-2 group-hover:scale-110 transition-transform">{CATEGORIES[category]?.icon}</div>
                                                    <div className="font-bold mb-1">{product}</div>
                                                    <div className="text-xs text-gray-500 dark:text-gray-400 bg-white dark:bg-gray-800 px-2 py-1 rounded-full">
                                                        {CATEGORIES[category]?.name}
                                                    </div>
                                                    <div className="absolute top-2 right-2 bg-green-500 text-white text-xl rounded-full w-8 h-8 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity shadow-lg">
                                                        +
                                                    </div>
                                                </button>
                                            ))
                                    )}
                                </div>
                                {Object.entries(PRODUCTS).flatMap(([_, products]) => products.filter(p => p.includes(searchTerm))).length === 0 && (
                                    <div className="text-center py-8">
                                        <div className="text-6xl mb-4">ğŸ”</div>
                                        <p className="text-gray-500 dark:text-gray-400 text-lg">×œ× × ××¦××• ××•×¦×¨×™× ×”×ª×•×××™× "<span className="font-bold">{searchTerm}</span>"</p>
                                        <p className="text-sm text-gray-400 dark:text-gray-500 mt-2">× ×¡×” ×—×™×¤×•×© ××—×¨ ××• ×‘×—×¨ ×§×˜×’×•×¨×™×”</p>
                                    </div>
                                )}
                            </div>
                        )}

                        {!selectedCategory && !searchTerm ? (
                            <div className="glass rounded-2xl shadow-xl p-6 mb-6">
                                <h2 className="text-2xl font-bold text-center mb-2 dark:text-white flex items-center justify-center gap-2">
                                    <span className="text-3xl">ğŸ·ï¸</span>
                                    <span className="text-gradient">×‘×—×¨ ×§×˜×’×•×¨×™×”</span>
                                </h2>
                                <p className="text-center text-gray-500 dark:text-gray-400 text-sm mb-6">××• ×”×©×ª××© ×‘×—×™×¤×•×© ×œ××¢×œ×” ×œ××¦×™××” ××”×™×¨×”</p>
                                <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                                    {Object.entries(CATEGORIES).map(([key, cat]) => {
                                        const count = items.filter(item => item.category === key && !item.purchased).length;
                                        return (
                                            <button
                                                key={key}
                                                onClick={() => setSelectedCategory(key)}
                                                className="relative glass p-6 rounded-2xl border-2 border-indigo-200/50 dark:border-indigo-700/50 hover:border-indigo-400 hover:shadow-2xl hover:scale-105 hover:-translate-y-1 transition-all duration-300 group overflow-hidden"
                                            >
                                                <div className="absolute inset-0 bg-gradient-to-br from-indigo-500/0 via-purple-500/0 to-pink-500/0 group-hover:from-indigo-500/10 group-hover:via-purple-500/10 group-hover:to-pink-500/10 transition-all duration-500"></div>
                                                <div className="relative">
                                                    <div className="text-5xl mb-3 group-hover:scale-125 group-hover:rotate-12 transition-all duration-300 float">{cat.icon}</div>
                                                    <div className="text-sm font-bold dark:text-white">{cat.name}</div>
                                                </div>
                                                {count > 0 && (
                                                    <div className="absolute top-2 left-2 bg-gradient-to-r from-red-500 to-pink-500 text-white text-xs font-bold rounded-full w-7 h-7 flex items-center justify-center shadow-lg animate-bounce">
                                                        {count}
                                                    </div>
                                                )}
                                            </button>
                                        );
                                    })}
                                </div>
                            </div>
                        ) : selectedCategory && !searchTerm && (
                            <div className="glass rounded-2xl shadow-xl p-6 mb-6">
                                <div className="flex justify-between items-center mb-6">
                                    <button onClick={() => setSelectedCategory(null)}
                                        className="btn-gradient text-white px-4 py-2 rounded-full font-semibold hover:shadow-lg hover:scale-105 transition-all">â† ×—×–×•×¨ ×œ×§×˜×’×•×¨×™×•×ª</button>
                                    <h2 className="text-2xl font-bold flex items-center gap-3 dark:text-white">
                                        <span className="text-4xl float">{CATEGORIES[selectedCategory].icon}</span>
                                        <span className="text-gradient">{CATEGORIES[selectedCategory].name}</span>
                                    </h2>
                                    <div className="w-32"></div>
                                </div>

                                <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3">
                                    {PRODUCTS[selectedCategory]?.map((product, idx) => (
                                        <button key={idx} onClick={() => addProduct(product)}
                                            className="relative bg-gradient-to-br from-green-50 via-emerald-50 to-teal-50 dark:from-green-900/30 dark:via-emerald-900/30 dark:to-teal-900/30 p-4 rounded-xl font-medium text-sm border-2 border-green-200 dark:border-green-700 hover:shadow-lg hover:scale-105 transition-all duration-300 dark:text-white group overflow-hidden">
                                            <div className="absolute inset-0 bg-gradient-to-r from-green-400/0 via-green-400/20 to-green-400/0 transform -translate-x-full group-hover:translate-x-full transition-transform duration-700"></div>
                                            <div className="relative">
                                                <div className="text-3xl mb-2 group-hover:scale-110 transition-transform">â•</div>
                                                <div className="font-bold">{product}</div>
                                            </div>
                                        </button>
                                    ))}
                                </div>
                            </div>
                        )}

                        {filteredItems.length > 0 && (
                            <div id="shopping-list-section" className="glass rounded-2xl shadow-xl p-6 mb-6">
                                <h2 className="text-2xl font-bold mb-6 dark:text-white flex items-center gap-3">
                                    <span className="text-3xl">ğŸ“</span>
                                    <span className="text-gradient">×”×¨×©×™××” ×©×œ×™</span>
                                    <span className="btn-gradient text-white text-sm px-3 py-1 rounded-full">{filteredItems.length}</span>
                                </h2>
                                {Object.entries(groupedItems).map(([category, categoryItems]) => (
                                    <div key={category} className="mb-6">
                                        <h3 className="text-lg font-bold text-indigo-700 dark:text-indigo-400 mb-3 pb-2 border-b-2 border-indigo-200/50 dark:border-indigo-700/50 flex items-center gap-2">
                                            <span className="text-2xl">{CATEGORIES[category]?.icon}</span>
                                            {CATEGORIES[category]?.name}
                                            <span className="text-xs bg-indigo-100 dark:bg-indigo-900/50 px-2 py-1 rounded-full">{categoryItems.length}</span>
                                        </h3>
                                        {categoryItems.map(item => (
                                            <div key={item.id} className={`p-4 rounded-xl mb-3 transition-all duration-300 card-hover ${item.purchased ? 'bg-gradient-to-r from-green-100/80 to-emerald-100/80 dark:from-green-900/30 dark:to-emerald-900/30 border-2 border-green-300 dark:border-green-700' : 'bg-white/60 dark:bg-gray-700/60 border-2 border-gray-200/50 dark:border-gray-600/50 hover:border-indigo-300'}`}>
                                                <div className="flex items-center gap-3">
                                                    <button onClick={() => togglePurchased(item.id, item.purchased)}
                                                        className={`w-7 h-7 rounded-full border-2 flex items-center justify-center flex-shrink-0 transition-all duration-300 ${item.purchased ? 'bg-gradient-to-r from-green-500 to-emerald-500 border-green-500 scale-110 shadow-lg' : 'border-gray-300 dark:border-gray-500 hover:border-green-400 hover:scale-110'}`}>
                                                        {item.purchased && <span className="text-white text-sm font-bold">âœ“</span>}
                                                    </button>
                                                    <div className="flex-1 min-w-0">
                                                        <span className={`font-medium text-lg ${item.purchased ? 'text-gray-400 dark:text-gray-500 line-through' : 'text-gray-800 dark:text-white'}`}>
                                                            {item.name}
                                                        </span>
                                                        <div className="flex items-center gap-2 mt-1">
                                                            <span className="text-xs text-gray-500 dark:text-gray-400">
                                                                ğŸ‘¤ {item.addedBy}
                                                            </span>
                                                            {item.note && (
                                                                <span className="text-xs bg-amber-100 dark:bg-amber-900/50 text-amber-700 dark:text-amber-300 px-2 py-0.5 rounded-full">
                                                                    ğŸ“ {item.note.length > 15 ? item.note.substring(0, 15) + '...' : item.note}
                                                                </span>
                                                            )}
                                                            {item.purchased && item.purchasedBy && (
                                                                <span className="text-xs text-green-600 dark:text-green-400">
                                                                    âœ“ × ×§× ×” ×¢×´×™ {item.purchasedBy}
                                                                </span>
                                                            )}
                                                        </div>
                                                    </div>
                                                    <div className="flex items-center gap-2 flex-shrink-0">
                                                        <button onClick={() => setEditingNote(item)}
                                                            className={`w-9 h-9 rounded-xl font-bold hover:scale-110 transition-all shadow-sm ${item.note ? 'bg-amber-100 dark:bg-amber-900/50 text-amber-600' : 'bg-gray-100 dark:bg-gray-600 text-gray-500'}`}
                                                            title="×”×•×¡×£ ×”×¢×¨×”">ğŸ“</button>
                                                        <button onClick={() => updateQuantity(item.id, item.quantity - 1)}
                                                            className="w-9 h-9 bg-gray-100 dark:bg-gray-600 rounded-xl font-bold hover:bg-gray-200 dark:hover:bg-gray-500 hover:scale-110 transition-all shadow-sm">-</button>
                                                        <span className="w-12 text-center font-bold text-lg text-gradient">{item.quantity}</span>
                                                        <button onClick={() => updateQuantity(item.id, item.quantity + 1)}
                                                            className="w-9 h-9 btn-gradient text-white rounded-xl font-bold hover:scale-110 transition-all shadow-md">+</button>
                                                    </div>
                                                    <button onClick={() => setShowDeleteConfirm(item.id)}
                                                        className="w-9 h-9 bg-red-100 dark:bg-red-900/50 rounded-xl text-red-500 dark:text-red-400 hover:bg-red-200 dark:hover:bg-red-800 hover:scale-110 flex-shrink-0 transition-all shadow-sm">ğŸ—‘</button>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                ))}
                            </div>
                        )}

                        {filteredItems.length === 0 && !searchTerm && (
                            <div className="glass rounded-2xl shadow-xl p-12 text-center">
                                <div className="text-7xl mb-6 float">ğŸ›’</div>
                                <p className="text-2xl text-gradient font-bold mb-2">×”×¨×©×™××” ×¨×™×§×”</p>
                                <p className="text-gray-500 dark:text-gray-400 mt-2">×”×ª×—×œ ×œ×”×•×¡×™×£ ××•×¦×¨×™× ××”×§×˜×’×•×¨×™×•×ª ××• ×“×¨×š ×”×—×™×¤×•×©</p>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        // Main App Content (inside FamilyProvider)
        function AppContent() {
            const { family, loading: familyLoading } = useFamily();

            if (familyLoading) {
                return (
                    <div className="min-h-screen gradient-bg flex items-center justify-center">
                        <div className="text-center">
                            <div className="text-6xl mb-4 float">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦</div>
                            <div className="text-xl text-white font-medium">×˜×•×¢×Ÿ ××©×¤×—×”...</div>
                            <div className="mt-4 w-32 h-1 bg-white/20 rounded-full overflow-hidden mx-auto">
                                <div className="h-full w-1/2 progress-animate rounded-full"></div>
                            </div>
                        </div>
                    </div>
                );
            }

            if (!family) {
                return <NoFamilyScreen />;
            }

            return <ShoppingList />;
        }

        // Main App Component
        function App() {
            const { user, loading } = useAuth();

            if (loading) {
                return (
                    <div className="min-h-screen gradient-bg flex items-center justify-center">
                        <div className="text-center">
                            <div className="text-6xl mb-4 float">ğŸ›’</div>
                            <div className="text-xl text-white font-medium">×˜×•×¢×Ÿ...</div>
                            <div className="mt-4 w-32 h-1 bg-white/20 rounded-full overflow-hidden mx-auto">
                                <div className="h-full w-1/2 progress-animate rounded-full"></div>
                            </div>
                        </div>
                    </div>
                );
            }

            if (!user) {
                return <AuthScreen />;
            }

            return (
                <FamilyProvider>
                    <AppContent />
                </FamilyProvider>
            );
        }

        ReactDOM.render(
            <AuthProvider>
                <App />
            </AuthProvider>,
            document.getElementById('root')
        );
    </script>
</body>
</html>
